(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{150:function(e,t,r){"use strict";r.r(t);var i=r(561);r.d(t,"AntiAirCutin",(function(){return i.a}));var n=r(3343);r.d(t,"CarrierBasedAerialCombat",(function(){return n.a}));var a=r(3344);r.d(t,"LandBaseAerialSupport",(function(){return a.a}));var o=r(231);r.d(t,"FleetAntiAir",(function(){return o.a}));var s=r(295);r.d(t,"ShipAntiAir",(function(){return s.a}))},162:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a}));var i=function(e){var t=(e.accuracy-e.evasion)*e.moraleModifier;return t<10?10:t>96?96:t},n=function(e){var t=e.criticalRateMultiplier,r=e.hitRateBonus,n=void 0===r?0:r,a=e.criticalRateBonus,o=void 0===a?0:a,s=i(e),c=Math.floor(s+1+n),u=Math.floor(Math.sqrt(s)*t+1+100*o),l=Math.min(c/100,1),f=Math.min(u/100,1);return{total:l,criticalRate:f,normalRate:l-f}},a=function(e){var t=Math.random();return t<e.criticalRate?"Critical":t<e.total?"Normal":"Miss"}},201:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n}));var i=function(e,t){var r=e[0],i=e[1];return Math.floor((i-r)*t/99+r)},n=function(e,t){var r=e[0],i=e[1],n=r;return t>=100&&(n+=r>=91?9:r>=70?8:r>=50?7:r>=40?6:r>=30?5:r>=8?4:3),Math.min(n,i)}},22:function(e,t,r){"use strict";var i=r(66);r.d(t,"a",(function(){return i}))},231:function(e,t,r){"use strict";var i=r(562),n=r(4120),a=r(564),o=function(e){var t=e.name,r=e.antiAir,i=e.improvement;if(0===r)return 0;return(e.is("AntiAircraftFireDirector")||e.is("HighAngleMount")?.35:e.is("AntiAircraftShell")?.6:e.is("Radar")?.4:"46cm三連装砲"===t?.25:.2)*r+i.fleetAntiAirModifier},s=function(e){return Math.floor(e.totalEquipmentStats(o))},c=function(){function e(e,t,r){this.ships=e,this.side=t,this.formationModifier=r}return Object.defineProperty(e.prototype,"fleetAntiAir",{get:function(){var e=this.ships,t=this.side,r=this.formationModifier,i=Object(a.a)(e,s),n=2*Math.floor(r*i);return"Player"===t?n/1.3:n},enumerable:!0,configurable:!0}),e}();t.a=c,c.getCombinedFleetModifier=function(e,t){return e===i.a.EscortFleet?.48:t===n.a.AirDefenseBattle?.72:.8},c.calcFleetAntiAir=function(e,t,r){var i=(0,e.totalShipStats)(s),n=2*Math.floor(r*i);return"Player"===t?n/1.3:n}},240:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var i=r(537),n=r(49),a=function(e){var t=e.shipType,r=e.shipClass,i=e.isInstallation,n=e.hasGear;return t.isAircraftCarrierClass||(r.is("RevisedKazahayaClass")||i)&&(n("DiveBomber")||n("TorpedoBomber"))?"CarrierShelling":"Shelling"},o=function(){function e(e){var t=this;this.ship=e,this.getProficiencyModifiers=function(e){return void 0===e&&(e=!1),"Shelling"===t.type?{power:1,hitRate:0,criticalRate:0}:e?t.ship.getSpecialProficiencyModifiers():t.ship.getNormalProficiencyModifiers()},this.calcBasicPower=function(e,r){void 0===r&&(r=!1);var i=t.ship;return 5+i.stats.firepower+(r?i.totalEquipmentStats((function(e){return e.is("TorpedoBomber")?0:e.improvement.shellingPowerModifier})):i.totalEquipmentStats((function(e){return e.improvement.shellingPowerModifier})))+e},this.getCarrierShellingFm=function(e){void 0===e&&(e=!1);var r=t,i=r.ship;if("Shelling"!==r.type){var n=e?0:i.totalEquipmentStats("torpedo"),a=e?i.totalEquipmentStats((function(e){return e.is("AntiInstallationBomber")?e.bombing:0})):i.totalEquipmentStats("bombing"),o=Math.floor(Math.floor(1.3*a)+n)+15;return function(e){return 25+Math.floor(1.5*(e+o))}}},this.calcPower=function(e){var r=e.fleetFactor,i=e.formationModifier,a=e.engagementModifier,o=e.isCritical,s=e.isAntiInstallation,c=e.isArmorPiercing,u=e.specialAttack,l=t.calcBasicPower(r,s),f=t.ship,p=f.health.shellingPowerModifier,h=f.getCruiserFitBonus(),d=u?u.modifier.power:1,g=t.getProficiencyModifiers(null==u?void 0:u.isCarrierSpecialAttack).power,m={a14:i*a*p,b14:h,a11:d};e.modifiers&&(m=Object(n.a)(m,e.modifiers));var b=t.getCarrierShellingFm(s);return Object(n.b)({basic:l,cap:180,modifiers:m,fm14prev:b,fm11next:function(e){return c&&(e=t.apShellFm(e)),o&&(e=Object(n.c)(g)(e)),e}})},this.calcAccuracy=function(e){var r=t.accuracyShipFactors,i=r.shipAccuracy,n=r.equipmentAccuracy,a=r.improvementModifier,o=r.moraleModifier,s=e.fleetFactor,c=e.formationModifier,u=e.specialAttackModifier,l=e.isArmorPiercing,f=e.fitGunBonus,p=1;l&&(p=t.apShellModifiers.accuracy);var h=Math.floor(s+i+n+a);return Math.floor((h*c*o+f)*u*p)}}return Object.defineProperty(e.prototype,"type",{get:function(){return a(this.ship)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"apShellModifiers",{get:function(){var e=this.ship.hasGear;return Object(i.b)({hasMainGun:e("MainGun"),hasArmorPiercingShell:e("ArmorPiercingShell"),hasSecondaryGun:e("SecondaryGun"),hasRader:e("Radar")})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"apShellFm",{get:function(){var e=this.apShellModifiers.power;return function(t){return Math.floor(t*e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracyShipFactors",{get:function(){var e=this.ship;return{shipAccuracy:e.shipAccuracy,equipmentAccuracy:e.totalEquipmentStats("accuracy"),improvementModifier:e.totalEquipmentStats((function(e){return e.improvement.shellingAccuracyModifier})),moraleModifier:e.morale.getAccuracyModifier("shelling")}},enumerable:!0,configurable:!0}),e}();t.a=o},241:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return l}));var i=r(39),n=[{attackerFleetType:i.a.CarrierTaskForce,defenderFleetType:i.a.Single,factors:[2,10]},{attackerFleetType:i.a.SurfaceTaskForce,defenderFleetType:i.a.Single,factors:[10,-5]},{attackerFleetType:i.a.TransportEscort,defenderFleetType:i.a.Single,factors:[-5,10]},{attackerFleetType:i.a.Single,defenderFleetType:i.a.Combined,factors:[5,5]},{attackerFleetType:i.a.CarrierTaskForce,defenderFleetType:i.a.Combined,factors:[2,-5]},{attackerFleetType:i.a.SurfaceTaskForce,defenderFleetType:i.a.Combined,factors:[2,-5]},{attackerFleetType:i.a.TransportEscort,defenderFleetType:i.a.Combined,factors:[-5,-5]}],a=[{attackerFleetType:i.a.Single,defenderFleetType:i.a.CarrierTaskForce,factors:[10,5]},{attackerFleetType:i.a.Single,defenderFleetType:i.a.SurfaceTaskForce,factors:[5,-5]},{attackerFleetType:i.a.Single,defenderFleetType:i.a.TransportEscort,factors:[10,5]}],o=[{fleetType:i.a.CarrierTaskForce,factors:[78,43]},{fleetType:i.a.SurfaceTaskForce,factors:[46,70]},{fleetType:i.a.TransportEscort,factors:[51,46]}],s=function(e,t){if(!e.fleetType.isCombined&&!t.fleetType.isCombined)return 0;var r="Main"===e.role?0:1;if("Player"===e.side){var i=n.find((function(r){return r.attackerFleetType===e.fleetType&&r.defenderFleetType===t.fleetType}));return i?i.factors[r]:0}if(e.fleetType.isCombined)return[10,-5][r];var o=a.find((function(r){return r.attackerFleetType===e.fleetType&&r.defenderFleetType===t.fleetType}));return o?o.factors[r]:0},c=function(e,t){var r=function(r){return e.side===r?e.fleetType:t.fleetType},i=r("Player").isCombined,n=r("Enemy").isCombined;return i||n?i&&!n?0:15:5},u=function(e){var t,r=e.fleetType,i="Main"===e.role?0:1,n=null===(t=o.find((function(e){return e.fleetType===r})))||void 0===t?void 0:t.factors[i];return null!=n?n:90},l=function(e,t){var r=s(e,t),i=u(e);return{shelling:r,torpedo:c(e,t),shellingAccuracy:i}}},295:function(e,t,r){"use strict";var i=function(e){var t=e.antiAir,r=e.improvement;if(0===t)return 0;var i=0;return e.is("AntiAircraftGun")?i=6:e.is("AntiAircraftFireDirector")||e.is("HighAngleMount")?i=4:e.is("Radar")&&(i=3),i*t+r.adjustedAntiAirModifier},n=function(){function e(e,t,r,i,n){var a=this;void 0===i&&(i=1),this.ship=e,this.side=t,this.fleetAntiAir=r,this.combinedFleetModifier=i,this.antiAirCutin=n,this.calcProportionalShotdownRate=function(e){void 0===e&&(e=1);var t=a,r=t.adjustedAntiAir,i=t.combinedFleetModifier;return Math.floor(r*e)*i*.5*.25*.02},this.calcFixedShotdownNumber=function(e,t){void 0===e&&(e=1),void 0===t&&(t=1);var r=a,i=r.adjustedAntiAir,n=r.fleetAntiAir,o=r.side,s=r.antiAirCutin,c=r.combinedFleetModifier,u="Player"===o?.8:.75,l=.5*(Math.floor(i*e)+Math.floor(n*t))*.25*u*c;return s&&(l*=s.fixedAirDefenseModifier),Math.floor(l)},this.getShotdownNumber=function(e){var t=e.slotSize,r=e.adjustedAntiAirResistModifier,i=e.fleetAntiAirResistModifier,n=0;if(Math.random()>.5){var o=a.calcProportionalShotdownRate(r);n+=Math.floor(t*o)}if(Math.random()>.5){var s=a.calcFixedShotdownNumber(r,i);n+=Math.floor(s)}return n+=a.minimumBonus}}return Object.defineProperty(e.prototype,"adjustedAntiAir",{get:function(){return function(e,t){var r=e.stats,n=e.nakedStats,a=(0,e.totalEquipmentStats)(i);if("Enemy"===t)return Math.floor(2*Math.floor(Math.sqrt(r.antiAir))+a);var o=n.antiAir+a;return 0===e.countGear()?o:2*Math.floor(o/2)}(this.ship,this.side)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimumBonus",{get:function(){var e=this.side,t=this.antiAirCutin;return t?t.minimumBonus:"Player"===e?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAirPropellantBarrageChance",{get:function(){var e,t=this.ship,r=this.adjustedAntiAir,i=t.shipType;if(!(e=i).isAircraftCarrierClass&&!e.any("AviationCruiser","AviationBattleship","SeaplaneTender"))return 0;var n=t.countGear(274);if(!n)return 0;var a=t.shipClass.is("IseClass")?.25:0;return(r+.9*t.stats.luck)/281+.15*(n-1)+a},enumerable:!0,configurable:!0}),e}();t.a=n},296:function(e,t,r){"use strict";var i=r(364),n=r(4113),a=r(562),o=r(231),s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},c=function(){function e(e,t,r,n,a){this.side=e,this.fleetType=t,this.landBase=r,this.mainFleet=n,this.escortFleet=a,this.formation=i.a.LineAhead,this.name="",this.isCombinedFleet&&(this.formation=i.a.CruisingFormation4)}return Object.defineProperty(e.prototype,"allShips",{get:function(){var e=this.mainFleet,t=this.escortFleet,r=e.nonNullableShips.concat();return t?r.concat(t.nonNullableShips):r},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetAntiAir",{get:function(){var e=this.allShips,t=this.side,r=this.formation;return new o.a(e,t,r.fleetAntiAirModifier).fleetAntiAir},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedFleet",{get:function(){return this.fleetType!==n.a.Single},enumerable:!0,configurable:!0}),e.prototype.getShipInformation=function(e){var t=this,r=t.mainFleet,i=t.escortFleet,n={side:t.side,fleetType:t.fleetType,fleetAntiAir:t.fleetAntiAir,formation:t.formation};return r.nonNullableShips.find((function(t){return t===e}))?s(s({},n),{fleetRole:a.a.MainFleet}):i&&i.nonNullableShips.find((function(t){return t===e}))?s(s({},n),{fleetRole:a.a.EscortFleet}):void 0},e}();t.a=c},297:function(e,t,r){"use strict";var i=function(){function e(e,t,r){this.player=e,this.enemy=t,this.battleType=r}return e.prototype.getShipInformation=function(e){var t=this.player,r=this.enemy,i=t.getShipInformation(e);if(i)return i;var n=r.getShipInformation(e);if(n)return n;throw console.error("ship info is not found")},e}();t.a=i},308:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(49),n={createPower:function(e){var t=e.nakedAsw,r=e.equipmentAsw,n=e.improvementModifier,a=e.typeConstant,o=e.formationModifier,s=e.engagementModifier,c=e.healthModifier,u=e.synergyModifier,l=e.optionalModifiers,f=e.fm11next,p=2*Math.sqrt(t)+1.5*r+n+a,h=o*s*c*u,d=l?Object(i.a)(l,{a14:h}):{a14:h};return Object(i.b)({basic:p,cap:150,modifiers:d,fm11next:f})},calcAccuracy:function(e){return(80+e.shipAccuracy+e.aswEquipmentModifier+e.improvementModifier)*e.formationModifier*e.moraleModifier}}},3342:function(e,t,r){"use strict";var i=r(150);r.d(t,"a",(function(){return i}))},3343:function(e,t,r){"use strict";var i,n=r(342),a=r(561),o=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(t){var r=e.call(this,t)||this,i=r.combatInformation,n=i.player,a=i.enemy;return n.isCombinedFleet&&a.isCombinedFleet?(r.playerAntiAirDefenseShips=n.allShips,r.enemyAntiAirDefenseShips=a.allShips):(r.playerAntiAirDefenseShips=n.mainFleet.nonNullableShips,r.enemyAntiAirDefenseShips=a.mainFleet.nonNullableShips),r}return o(t,e),t.prototype.main=function(){var e=this.playerAntiAirDefenseShips,t=this.enemyAntiAirDefenseShips,r=this.combatInformation,i=e.flatMap((function(e){return e.planes})),n=t.flatMap((function(e){return e.planes})),o=function(e){return e.is("DiveBomber")||e.is("TorpedoBomber")||e.is("Fighter")},s=i.filter(o),c=n.filter(o),u=this.fighterCombat(s,c),l=r.player,f=(r.enemy,s.filter((function(e){return e.slotSize>0&&e.participatesInAirstrike}))),p=c.filter((function(e){return e.slotSize>0&&e.participatesInAirstrike}));return this.antiAirDefense(e,p,a.a.try(l.allShips)),this.antiAirDefense(t,f,a.a.try(l.allShips)),{airControlState:u}},t}(n.a);t.a=s},3344:function(e,t,r){"use strict";var i,n=r(4122),a=r(365),o=r(342),s=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t,r){var i=e.call(this,t)||this;return i.landBasedAirCorps=r,i}return s(t,e),t.prototype.main=function(){var e=this,t=this.combatInformation.enemy,r=this.landBasedAirCorps,i=r.fighterPower,o=r.planes,s=Object(n.a)(t.allShips,(function(e){return e.planes})),c=s.reduce((function(e,t){return e+t.fighterPower}),0),u=a.a.fromFighterPower(i,c),l=function(e){return e.is("DiveBomber")||e.is("TorpedoBomber")||e.is("Fighter")||e.is("ReconnaissanceAircraft")},f=o.filter(l),p=s.filter(l);f.forEach((function(t){return e.shotdownInFighterCombat(t,u.constant,"Player")})),p.forEach((function(t){return e.shotdownInFighterCombat(t,u.constant,"Enemy")}));var h=f.filter((function(e){return e.slotSize>0&&e.participatesInAirstrike}));return this.antiAirDefense(t.allShips,h),{airControlState:u}},t}(o.a);t.a=c},342:function(e,t,r){"use strict";var i=r(3489),n=r(365),a=r(295),o=r(231),s=function(){function e(e){var t=this;this.combatInformation=e,this.shotdownInFighterCombat=function(e,t,r){var i;if("Player"===r){var n=t/4,a=Math.floor(t/3*100);i=Math.floor(Math.random()*(a+1))/100+n}else{a=11-t;i=.35*Math.floor(Math.random()*(a+1))+.65*Math.floor(Math.random()*(a+1))}var o=i/10,s=Math.floor(e.slotSize*o);e.is("JetPoweredAircraft")?e.shotdown(.6*s):e.shotdown(s)},this.shipAntiAirDefense=function(e,r,i){var n=t.combatInformation.battleType,s=t.combatInformation.getShipInformation(e),c=s.side,u=s.fleetRole,l=s.fleetAntiAir,f=o.a.getCombinedFleetModifier(u,n),p=new a.a(e,c,l,f,i).getShotdownNumber(r);r.shotdown(p)}}return e.prototype.fighterCombat=function(e,t){var r=this,i=e.reduce((function(e,t){return e+t.fighterPower}),0),a=t.reduce((function(e,t){return e+t.fighterPower}),0),o=n.a.fromFighterPower(i,a);return e.forEach((function(e){return r.shotdownInFighterCombat(e,o.constant,"Player")})),t.forEach((function(e){return r.shotdownInFighterCombat(e,o.constant,"Enemy")})),o},e.prototype.antiAirDefense=function(e,t,r){for(var n=0,a=t;n<a.length;n++){var o=a[n],s=e[Object(i.a)(e.length-1)];this.shipAntiAirDefense(s,o,r)}},e}();t.a=s},3425:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r(49),n=r(240),a=r(557),o=r(558),s=r(559),c=r(560),u=function(e){var t=e.ship,r=e.target,u=e.fleetFactors,l=e.formation,f=e.role,p=e.engagement,h=e.isArmorPiercing,d=e.nightContactModifier,g=e.optionalPowerModifiers,m=l.getModifiers(f),b=p.modifier,y=r.isInstallation,v=t.getSpecialEnemyModifiers(r),A=new n.a(t),M=new a.a(t),w=o.a.fromShip(t),S=s.a.fromShip(t,"Day"),P=new c.a(t);return{calcShellingPower:function(e,t){var r=Object(i.a)(v,g);return A.calcPower({fleetFactor:u.shelling,formationModifier:m.shelling.power,engagementModifier:b,modifiers:r,isCritical:e,isAntiInstallation:y,isArmorPiercing:h,specialAttack:t})},calcShellingSupportPower:function(e){var t=l.shellingSupportModifiers.power;return M.calcPower({formationModifier:t,engagementModifier:b,isCritical:e,isAntiInstallation:y})},calcTorpedoPower:function(e){return w.calcPower({fleetFactor:u.torpedo,formationModifier:m.torpedo.power,engagementModifier:b,isCritical:e,optionalModifiers:g})},calcAswPower:function(e){return S.calcPower({formationModifier:m.asw.power,engagementModifier:b,isCritical:e,optionalModifiers:g})},calcNightPower:function(e,t){var r=Object(i.a)(v,g);return P.calcPower({formationModifier:m.night.power,nightContactModifier:d,specialAttack:t,modifiers:r,isCritical:e,isAntiInstallation:y})},canDoTorpedoAttack:t.nakedStats.torpedo>0,canDoAsw:"None"!==S.type}}},3434:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var i=function(e){return!!e.shipType.isAircraftCarrierClass&&(!(![545,599,610].includes(e.shipId)&&!e.hasGear((function(e){return[258,259].includes(e.gearId)})))&&e.planes.some((function(e){return e.slotSize>0&&e.isNightPlane})))},n=function(e){var t=e.nakedStats,r=e.level;return t.luck<50?Math.floor(t.luck+15+.75*Math.sqrt(r)):Math.floor(Math.sqrt(t.luck-50)+65+.8*Math.sqrt(r))},a=function(){function e(t,r,i,n){var a=this;this.id=t,this.name=r,this.typeFactor=i,this.modifier=n,this.calcRate=function(t){return a===e.DoubleAttack?109/110:Math.ceil(t)/a.typeFactor}}return Object.defineProperty(e.prototype,"api",{get:function(){return Math.floor(this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDestroyerCutin",{get:function(){return 7===this.id||8===this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAerialAttack",{get:function(){return 6===this.api},enumerable:!0,configurable:!0}),e}();t.a=a,a.DoubleAttack=new a(1,"連撃",110,{power:1.2,accuracy:1.1}),a.MainTorp=new a(2,"主魚",115,{power:1.3,accuracy:1.5}),a.TorpTorp=new a(3,"魚雷",122,{power:1.5,accuracy:1.65}),a.SubmarineTorpTorp=new a(3.1,"潜水魚雷",110,{power:1.65,accuracy:1}),a.SubmarineRadarTorp=new a(3.2,"潜水電探",102,{power:1.75,accuracy:1}),a.MainMainSecond=new a(4,"主副",130,{power:1.75,accuracy:1.65}),a.MainMainMain=new a(5,"主砲",140,{power:2,accuracy:1.5}),a.AerialAttack1=new a(6.1,"夜襲1.25",105,{power:1.25,accuracy:1}),a.AerialAttack2=new a(6.2,"夜襲1.20",115,{power:1.2,accuracy:1}),a.AerialAttack3=new a(6.3,"夜襲1.18",125,{power:1.18,accuracy:1}),a.SuiseiAttack=new a(6.4,"彗星夜襲",115,{power:1.2,accuracy:1}),a.MainTorpRadar=new a(7,"主魚電",130,{power:1.3,accuracy:1}),a.TorpRadarLookout=new a(8,"魚見電",150,{power:1.2,accuracy:1}),a.getPossibleAerialAttacks=function(e){var t=[],r=e.planes.filter((function(e){return e.slotSize>0})),i=r.filter((function(e){return e.isNightFighter})).length,n=r.filter((function(e){return e.isNightAttacker})).length,o=r.filter((function(e){return e.isNightPlane})).length,s=r.filter((function(e){return e.isNightAircraft&&!e.isNightPlane})).length,c=i>=1,u=n>=1,l=o>=1,f=r.some((function(e){return 320===e.gear.gearId}));return i>=2&&u&&t.push(a.AerialAttack1),c&&u&&t.push(a.AerialAttack2),l&&f&&t.push(a.SuiseiAttack),c?((i+s>=3||n+s>=2)&&t.push(a.AerialAttack3),t):t},a.getPossibleAttacks=function(e,t){void 0===t&&(t=!1);var r=e.shipType,n=e.hasGear,o=e.countGear,s=new Array;if(i(e))return a.getPossibleAerialAttacks(e);if(!e.canNightAttack)return s;var c=t?0:o((function(e){return[213,214,383].includes(e.gearId)})),u=t?0:o("Torpedo")+o("SubmarineTorpedo");r.is("Destroyer")&&n((function(e){return e.is("SurfaceRadar")}))&&u>=1&&(n((function(e){return e.is("SmallCaliberMainGun")}))&&s.push(a.MainTorpRadar),n(129)&&s.push(a.TorpRadarLookout));var l=o((function(e){return e.is("MainGun")})),f=o((function(e){return e.is("SecondaryGun")}));return c>=1&&n((function(e){return e.is("SubmarineEquipment")}))?s.push(a.SubmarineRadarTorp):c>=2?s.push(a.SubmarineTorpTorp):l>=3?s.push(a.MainMainMain):l>=2&&f>=1?s.push(a.MainMainSecond):u>=2?s.push(a.TorpTorp):l>=1&&u>=1?s.push(a.MainTorp):l+f>=2&&s.push(a.DoubleAttack),s},a.calcPreModifierValue=n,a.calcBaseValue=function(e,t,r,i){var a=n(e);return t&&(a+=15),"Chuuha"===e.health.damage&&(a+=18),e.hasGear(129)&&(a+=5),r.searchlight&&(a+=7),i.searchlight&&(a+=-5),r.starshell&&(a+=4),i.starshell&&(a+=-10),a}},3465:function(e,t,r){"use strict";var i=r(564),n=function(e){var t=this;this.planes=e,this.calcRate=function(e){var r,n,a=t.planes,o=e.contactMultiplier,s=function(e,t){return 0===t?0:Math.min((e+1)/(70-15*t),1)}(Object(i.a)(a.filter((function(e){return e.is("ReconnaissanceAircraft")})),(function(e){return e.contactTriggerFactor})),o),c=((r={})[1.2]=0,r[1.17]=0,r[1.12]=0,r),u=s*a.filter((function(e){return e.canContact})).sort((function(e,t){return t.gear.accuracy-e.gear.accuracy})).reduce((function(t,r){var i=(1-t)*r.contactSelectionRate(e),n=r.gear.accuracy;return n>=3?c[1.2]+=i:2===n?c[1.17]+=i:c[1.12]+=i,t+i}),0),l=((n={})[1.2]=c[1.2]*s,n[1.17]=c[1.17]*s,n[1.12]=c[1.12]*s,n);return{successRate:u,triggerRate:s,selectionRateMap:c,rateMap:l,airControlState:e}},this.getContactModifier=function(e){if(0===e.contactMultiplier)return 1;var r=t.calcRate(e).rateMap,i=Math.random();return i<r[1.2]?1.2:i<r[1.2]+r[1.17]?1.17:i<r[1.2]+r[1.17]+r[1.12]?1.12:1}};t.a=n},3482:function(e,t,r){"use strict";r.d(t,"b",(function(){return S}));var i=r(42),n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.includes(t.gearId)}},a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.map(i.b.keyToId).includes(t.categoryId)}},o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.every((function(e){return e(t)}))}},s=a("SmallCaliberMainGun","MediumCaliberMainGun","LargeCaliberMainGun","LargeCaliberMainGun2"),c=a("SmallRadar","LargeRadar","LargeRadar2"),u=o(c,(function(e){return e.los>=5})),l=o(c,(function(e){return e.antiAir>=2})),f=a("ExtraArmor","MediumExtraArmor","LargeExtraArmor"),p=a("CarrierBasedFighterAircraft","CarrierBasedDiveBomber","CarrierBasedTorpedoBomber","CarrierBasedReconnaissanceAircraft","CarrierBasedReconnaissanceAircraft2"),h=a("ReconnaissanceSeaplane","SeaplaneBomber","SeaplaneFighter","LargeFlyingBoat"),d=a("LandBasedAttackAircraft","LandBasedFighter","LandBasedReconnaissanceAircraft","LargeLandBasedAircraft"),g=a("JetPoweredFighter","JetPoweredFighterBomber","JetPoweredTorpedoBomber","JetPoweredReconnaissanceAircraft"),m=a("CarrierBasedFighterAircraft","SeaplaneFighter","LandBasedFighter","JetPoweredFighter"),b=a("CarrierBasedDiveBomber","SeaplaneBomber","JetPoweredFighterBomber"),y=a("CarrierBasedTorpedoBomber","JetPoweredTorpedoBomber","LandBasedAttackAircraft"),v=a("CarrierBasedReconnaissanceAircraft","CarrierBasedReconnaissanceAircraft2","ReconnaissanceSeaplane","LargeFlyingBoat","JetPoweredReconnaissanceAircraft","LandBasedReconnaissanceAircraft"),A={Abyssal:function(e){return e.gearId>500},HighAngleMount:function(e){return 16===e.iconId},MainGun:s,Radar:c,SurfaceRadar:u,AirRadar:l,Armor:f,CarrierBasedAircraft:p,Seaplane:h,LandBasedAircraft:d,JetPoweredAircraft:g,Fighter:m,DiveBomber:b,TorpedoBomber:y,ReconnaissanceAircraft:v,FighterBomber:o(a("CarrierBasedDiveBomber"),(function(e){return e.antiAir>=1})),Aircraft:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.some((function(e){return e(t)}))}}(m,b,y,v,a("Autogyro","AntiSubmarinePatrolAircraft")),AntiInstallationBomber:n(60,64,305,306,148,233,277,319),AswGear:a("Sonar","DepthCharge","LargeSonar","CarrierBasedDiveBomber","CarrierBasedTorpedoBomber","SeaplaneBomber","Autogyro","AntiSubmarinePatrolAircraft"),AswAircraft:o((function(e){return e.asw>0}),a("CarrierBasedDiveBomber","CarrierBasedTorpedoBomber","SeaplaneBomber","Autogyro","AntiSubmarinePatrolAircraft","LargeFlyingBoat")),DepthChargeProjector:n(44,45),AdditionalDepthCharge:n(226,227),AntiGroundRocketLauncher:n(348,349),Mortar:n(346,347)},M=Object.keys(A),w={from:function(e){var t=function(e){return M.filter((function(t){return A[t](e)}))}(e),r=i.b.numberToKey(e.categoryId);return r&&t.push(r),t}},S=["armor","firepower","torpedo","speed","bombing","antiAir","asw","los","accuracy","evasion","interception","antiBomber","range","radius"],P=function(){function e(e,t,r){var n=this;this.category=t,this.improvable=r,this.radius=0,this.is=function(e){return n.attrs.includes(e)},this.id=e.api_id,this.name=e.api_name,this.categoryId=t.id,this.iconId=e.api_type[3],this.hp=e.api_taik,this.armor=e.api_souk,this.firepower=e.api_houg,this.torpedo=e.api_raig,this.speed=e.api_soku,this.bombing=e.api_baku,this.antiAir=e.api_tyku,this.asw=e.api_tais,this.los=e.api_saku,this.luck=e.api_luck,this.range=e.api_leng;var a=e.api_houm,o=e.api_houk;this.accuracy=0,this.evasion=0,this.antiBomber=0,this.interception=0,this.categoryId===i.a.LandBasedFighter?(this.antiBomber=a,this.interception=o):(this.accuracy=a,this.evasion=o),e.api_distance&&(this.radius=e.api_distance),this.attrs=w.from(this)}return Object.defineProperty(e.prototype,"gearId",{get:function(){return this.id},enumerable:!0,configurable:!0}),e}();t.a=P},35:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return n})),r.d(t,"e",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return s}));var i=function(e){return null!=e},n=i,a=function(e,t){return t<=e?t:e+Math.sqrt(t-e)},o=function(e){return e.health.currentHp+e.getDefensePower().max},s=function(e){return e[Math.floor(Math.random()*e.length)]}},364:function(e,t,r){"use strict";var i=function(){return(i=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},n=function(){function e(t,r,n){var a=this;this.id=t,this.name=r,this.modifiers=n,this.getModifiers=function(t){return a!==e.Vanguard?a.modifiers:i(i({},a.modifiers),"Main"===t?{shelling:{power:.5,accuracy:.8,evasion:1},torpedo:{power:1,accuracy:.75,evasion:1},asw:{power:1,accuracy:1,evasion:1},night:{power:.5,accuracy:1,evasion:1}}:{shelling:{power:1,accuracy:1.2,evasion:1},torpedo:{power:1,accuracy:.95,evasion:1},asw:{power:.6,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}})},e.values.push(this)}return Object.defineProperty(e,"singleFleetFormations",{get:function(){return e.values.filter((function(e){return e.id<=10}))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"combinedFleetFormations",{get:function(){return e.values.filter((function(e){return e.id>10}))},enumerable:!0,configurable:!0}),e.fromId=function(t){return e.values.find((function(e){return e.id===t}))},Object.defineProperty(e.prototype,"fleetAntiAirModifier",{get:function(){return this.modifiers.fleetAntiAir},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedFleetFormation",{get:function(){return this.id>10},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shellingSupportModifiers",{get:function(){return this===e.Vanguard?{power:.5,accuracy:.8}:this.isCombinedFleetFormation?{power:1,accuracy:1}:this.getModifiers("Main").shelling},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protectionRate",{get:function(){return this===e.LineAhead?.45:this===e.Diamond?.75:.6},enumerable:!0,configurable:!0}),e}();t.a=n,n.keys=["LineAhead","DoubleLine","Diamond","Echelon","LineAbreast","Vanguard","CruisingFormation1","CruisingFormation2","CruisingFormation3","CruisingFormation4"].concat(),n.values=[],n.LineAhead=new n(1,"単縦陣",{fleetAntiAir:1,shelling:{power:1,accuracy:1,evasion:1},torpedo:{power:1,accuracy:1,evasion:1},asw:{power:.6,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.DoubleLine=new n(2,"複縦陣",{fleetAntiAir:1.2,shelling:{power:.8,accuracy:1.2,evasion:1},torpedo:{power:.8,accuracy:.8,evasion:1},asw:{power:.8,accuracy:1.2,evasion:1},night:{power:1,accuracy:.9,evasion:1}}),n.Diamond=new n(3,"輪形陣",{fleetAntiAir:1.6,shelling:{power:.7,accuracy:1,evasion:1.1},torpedo:{power:.7,accuracy:.4,evasion:1.1},asw:{power:1.2,accuracy:1,evasion:1},night:{power:1,accuracy:.7,evasion:1}}),n.Echelon=new n(4,"梯形陣",{fleetAntiAir:1,shelling:{power:.75,accuracy:1.2,evasion:1.2},torpedo:{power:.6,accuracy:.6,evasion:1.3},asw:{power:1.1,accuracy:1.2,evasion:1.3},night:{power:1,accuracy:.9,evasion:1.2}}),n.LineAbreast=new n(5,"単横陣",{fleetAntiAir:1,shelling:{power:.6,accuracy:1.2,evasion:1.3},torpedo:{power:.6,accuracy:.3,evasion:1.4},asw:{power:1.3,accuracy:1.2,evasion:1.1},night:{power:1,accuracy:.8,evasion:1.2}}),n.Vanguard=new n(6,"警戒陣",{fleetAntiAir:1.1,shelling:{power:1,accuracy:1,evasion:1},torpedo:{power:1,accuracy:1,evasion:1},asw:{power:1,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.CruisingFormation1=new n(11,"第一警戒航行序列",{fleetAntiAir:1.1,shelling:{power:.8,accuracy:1,evasion:1},torpedo:{power:.7,accuracy:1,evasion:1},asw:{power:1.3,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.CruisingFormation2=new n(12,"第二警戒航行序列",{fleetAntiAir:1,shelling:{power:1,accuracy:1,evasion:1},torpedo:{power:.9,accuracy:1,evasion:1},asw:{power:1.1,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.CruisingFormation3=new n(13,"第三警戒航行序列",{fleetAntiAir:1.5,shelling:{power:.7,accuracy:1,evasion:1},torpedo:{power:.6,accuracy:1,evasion:1},asw:{power:1,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.CruisingFormation4=new n(14,"第四警戒航行序列",{fleetAntiAir:1,shelling:{power:1.1,accuracy:1.1,evasion:1},torpedo:{power:1,accuracy:1,evasion:1},asw:{power:.7,accuracy:1,evasion:1},night:{power:1,accuracy:1,evasion:1}}),n.isIneffective=function(e,t){return[[n.DoubleLine,n.LineAbreast],[n.LineAbreast,n.Echelon],[n.Echelon,n.LineAhead]].some((function(r){return r[0]===e&&r[1]===t}))}},365:function(e,t,r){"use strict";var i=function(){function e(t,r,i){this.id=t,this.name=r,this.constant=i,e.values.push(this)}return e.fromFighterPower=function(t,r){var i=e.getBoundaryValues(r);return t>=i.AirSupremacy?e.AirSupremacy:t>=i.AirSuperiority?e.AirSuperiority:t>=i.AirParity?e.AirParity:t>=i.AirDenial?e.AirDenial:e.AirIncapability},e.fromId=function(t){return e.values.find((function(e){return e.id===t}))},Object.defineProperty(e.prototype,"contactMultiplier",{get:function(){switch(this){case e.AirSupremacy:return 3;case e.AirSuperiority:return 2;case e.AirDenial:return 1;default:return 0}},enumerable:!0,configurable:!0}),e}();t.a=i,i.values=[],i.AirSupremacy=new i(1,"制空権確保",1),i.AirSuperiority=new i(2,"航空優勢",3),i.AirParity=new i(0,"制空均衡",5),i.AirDenial=new i(3,"航空劣勢",7),i.AirIncapability=new i(4,"制空権喪失",10),i.getBoundaryValues=function(e){return{AirSupremacy:Math.ceil(3*e),AirSuperiority:Math.ceil(1.5*e),AirParity:Math.floor(2/3*e)+1,AirDenial:Math.floor(1/3*e)+1}}},39:function(e,t,r){"use strict";var i=function(){function e(t,r,i){this.id=t,this.key=r,this.name=i,e.values.push(this)}return Object.defineProperty(e.prototype,"isCombined",{get:function(){return this!==e.Single},enumerable:!0,configurable:!0}),e}();t.a=i,i.values=[],i.Single=new i(0,"Single","通常艦隊"),i.CarrierTaskForce=new i(1,"CarrierTaskForce","空母機動部隊"),i.SurfaceTaskForce=new i(2,"SurfaceTaskForce","水上打撃部隊"),i.TransportEscort=new i(3,"TransportEscort","輸送護衛部隊"),i.Combined=new i(5,"Combined","敵連合"),i.fromId=function(e){return i.values.find((function(t){return t.id===e}))},i.fromString=function(e){return i.values.find((function(t){return t.key===e||t.name===e}))}},4109:function(e,t,r){"use strict";var i=r(4234),n=r(606),a=r(303),o=r.n(a),s=function(){function e(e,t,r,i,a){var s=this;this.stats=e,this.category=t,this.improvement=r,this.proficiency=i,this.attrs=a,this.is=function(e){return s.attrs.includes(e)},this.match=function(e){return"number"==typeof e?s.gearId===e:o()(e)(s)},this.toState=function(){return{gearId:s.gearId,star:s.star,exp:s.exp}},this.calcFighterPower=function(e,t){void 0===t&&(t=!1);var r=s,i=r.antiAir,a=r.interception,o=r.antiBomber,c=r.improvement,u=r.proficiency,l=c.fighterPowerModifier,f=u.fighterPowerBonus;return Object(n.a)({slotSize:e,antiAir:i,interception:a,antiBomber:o,improvementModifier:l,proficiencyModifier:f,isInterception:t})}}return Object.defineProperty(e.prototype,"gearId",{get:function(){return this.stats.gearId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryId",{get:function(){return this.stats.categoryId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconId",{get:function(){return this.stats.iconId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.stats.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"improvable",{get:function(){return this.stats.improvable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hp",{get:function(){return this.stats.hp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firepower",{get:function(){return this.stats.firepower},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"armor",{get:function(){return this.stats.armor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedo",{get:function(){return this.stats.torpedo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAir",{get:function(){return this.stats.antiAir},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.stats.speed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bombing",{get:function(){return this.stats.bombing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asw",{get:function(){return this.stats.asw},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"los",{get:function(){return this.stats.los},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"luck",{get:function(){return this.stats.luck},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this.stats.range},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){return this.stats.accuracy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){return this.stats.evasion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiBomber",{get:function(){return this.stats.antiBomber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interception",{get:function(){return this.stats.interception},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.stats.radius},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"masterId",{get:function(){return this.gearId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"star",{get:function(){return this.improvement.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exp",{get:function(){return this.proficiency.internal},enumerable:!0,configurable:!0}),e}(),c=r(42),u=function(){function e(e,t,r){void 0===e&&(e=0),this.value=e,this.stats=t,this.gearIs=r}return Object.defineProperty(e.prototype,"star",{get:function(){return this.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contactSelectionModifier",{get:function(){var e=this.value,t=this.gearIs;if(!t("ReconnaissanceAircraft"))return 0;var r=this.stats.los;if(t("CarrierBasedReconnaissanceAircraft")||t("CarrierBasedReconnaissanceAircraft2")){if(7===r)return.25*e;if(11===r)return.4*e}else{if(6===r)return.2*e;if(r>=4)return.14*e;if(3===r)return.1*e}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPowerModifier",{get:function(){var e=this.star,t=this.gearIs;return t("Fighter")?.2*e:t("FighterBomber")?.25*e:t("LandBasedAttackAircraft")?.5*Math.sqrt(e):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adjustedAntiAirModifier",{get:function(){var e=this.gearIs,t=this.stats.antiAir;if(0===t)return 0;var r=0;return e("AntiAircraftGun")?r=t<=7?4:6:(e("AntiAircraftFireDirector")||e("HighAngleMount"))&&(r=t<=7?2:3),r*Math.sqrt(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetAntiAirModifier",{get:function(){var e=this.gearIs,t=this.stats.antiAir;if(0===t)return 0;var r=0;return e("AntiAircraftFireDirector")||e("HighAngleMount")?r=t<=7?2:3:e("AirRadar")&&(r=1.5),r*Math.sqrt(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shellingPowerModifier",{get:function(){var e=this.stats,t=e.firepower,r=e.gearId,i=this.gearIs;return t>12?1.5*Math.sqrt(this.value):i("CarrierBasedTorpedoBomber")||[10,66,220,275,358].includes(r)?.2*this.value:[12,234,247].includes(r)?.3*this.value:i("MainGun")||i("SecondaryGun")||i("ArmorPiercingShell")||i("AntiAircraftFireDirector")||i("Searchlight")||i("LargeSearchlight")||i("AntiAircraftGun")||i("LandingCraft")||i("SpecialAmphibiousTank")||i("AntiAircraftShell")||i("AntiGroundEquipment")?Math.sqrt(this.value):i("Sonar")||i("LargeSonar")||i("DepthChargeProjector")||i("Mortar")?.75*Math.sqrt(this.value):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shellingAccuracyModifier",{get:function(){var e=this.gearIs;return e("SurfaceRadar")?1.7*Math.sqrt(this.value):e("Radar")||e("MainGun")||e("SecondaryGun")||e("ArmorPiercingShell")||e("AntiAircraftFireDirector")?Math.sqrt(this.value):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aswPowerModifier",{get:function(){var e=this.gearIs,t=this.stats,r=this.star;return e("CarrierBasedTorpedoBomber")?.2*r:e("DepthCharge")||e("Sonar")?Math.sqrt(r):e("Autogyro")?(t.asw>10?.3:.2)*r:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aswAccuracyModifier",{get:function(){var e=this.star;switch(this.stats.categoryId){case c.a.Sonar:case c.a.LargeSonar:case c.a.DepthCharge:return 1.3*Math.sqrt(e)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedoPowerModifier",{get:function(){var e=this.star;switch(this.stats.categoryId){case c.a.Torpedo:case c.a.AntiAircraftGun:return 1.2*Math.sqrt(e)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedoAccuracyModifier",{get:function(){var e=this.star;switch(this.stats.categoryId){case c.a.Torpedo:case c.a.MidgetSubmarine:return 2*Math.sqrt(e)}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedoEvasionModifier",{get:function(){var e=this.star,t=this.gearIs;return t("Sonar")||t("LargeSonar")?1.5*Math.sqrt(e):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nightAttackPowerModifier",{get:function(){var e=this.gearIs,t=this.stats.gearId;return[10,66,220,275,358].includes(t)?.2*this.value:[12,234,247].includes(t)?.3*this.value:e("MainGun")||e("SecondaryGun")||e("ArmorPiercingShell")||e("AntiAircraftShell")||e("Searchlight")||e("LargeSearchlight")||e("AntiAircraftFireDirector")||e("LandingCraft")||e("SpecialAmphibiousTank")||e("AntiGroundEquipment")||e("Torpedo")||e("MidgetSubmarine")?Math.sqrt(this.value):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nightAttackAccuracyModifier",{get:function(){var e=this.gearIs,t=this.value;return e("SurfaceRadar")?1.6*Math.sqrt(t):e("MediumCaliberMainGun")||e("Radar")?1.3*Math.sqrt(t):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"effectiveLosModifier",{get:function(){var e=this.gearIs,t=this.value;return e("SmallRadar")?1.25*Math.sqrt(t):e("LargeRadar")||e("LargeRadar2")?1.4*Math.sqrt(t):e("CarrierBasedReconnaissanceAircraft")||e("CarrierBasedReconnaissanceAircraft2")||e("ReconnaissanceSeaplane")?1.2*Math.sqrt(t):e("SeaplaneBomber")?1.15*Math.sqrt(t):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defensePowerModifier",{get:function(){var e=this.gearIs;return e("MediumExtraArmor")?.2*this.value:e("LargeExtraArmor")?.3*this.value:0},enumerable:!0,configurable:!0}),e}(),l=r(543),f=function(e){var t=this;this.masters=e,this.create=function(e){if(e){var r=t.masters.find((function(t){return t.id===e.masterId}));if(r){var i=l.a.from(r.attrs),n=new u(e.improvement,r,r.is),a=new l.b(e.proficiency,i);return new s(r,r.category,n,a,r.attrs)}}}},p=r(564),h=r(4122),d=r(35),g=function(e){var t=e.los,r=e.improvement,i=.6;return e.is("CarrierBasedTorpedoBomber")?i=.8:e.is("CarrierBasedReconnaissanceAircraft")||e.is("CarrierBasedReconnaissanceAircraft2")?i=1:e.is("ReconnaissanceSeaplane")?i=1.2:e.is("SeaplaneBomber")&&(i=1.1),i*(t+r.effectiveLosModifier)},m=function(e,t,r){void 0===r&&(r=!1);var i,n=e.nakedStats,a=e.stats,o=e.totalEquipmentStats,s=e.gears;if(r){var c=s.filter((function(e,t){return t!==s.length-1})).filter(d.b);i=Object(p.a)(c,g)}else i=o(g);var u=a.getBonus("effectiveLos");return Math.sqrt(n.los+u)+i*t-2},b=function(e,t,r,i){return e.totalShipStats((function(e){return m(e,t,i)}))-Math.ceil(.4*r)+12},y=r(88),v=function(e){return[68,166,193,167].includes(e.gearId)},A=function(e){switch(e.gearId){case 68:case 193:return.05;case 166:return.02;case 167:return.01}return 0},M=function(e){if(e.category.is("LandingCraft"))return 8;if(e.category.is("CombatRation"))return 1;switch(e.gearId){case 75:return 5;case 167:return 2}return 0},w=function(e){return e.totalEquipmentStats(M)+function(e){switch(e){case y.a.SubmarineAircraftCarrier:return 1;case y.a.Destroyer:return 5;case y.a.LightCruiser:return 2;case y.a.AviationCruiser:return 4;case y.a.AviationBattleship:return 7;case y.a.FleetOiler:case y.a.AmphibiousAssaultShip:return 12;case y.a.SeaplaneTender:return 9;case y.a.SubmarineTender:return 7;case y.a.TrainingCruiser:return 6}return 0}(e.shipTypeId)+(487===e.shipId?8:0)},S=function(){function e(e){var t=this;this.ships=e,this.totalShipStats=function(e){return Object(p.a)(t.nonNullableShips,e)},this.effectiveLos=function(e,r,i){return b(t,e,r,i)}}return Object.defineProperty(e.prototype,"nonNullableShips",{get:function(){return this.ships.filter(d.b)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"planes",{get:function(){return Object(h.a)(this.nonNullableShips,(function(e){return e.planes}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasUnknownSlot",{get:function(){return this.nonNullableShips.flatMap((function(e){return e.slots})).some((function(e){return e<0}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPower",{get:function(){return Object(p.a)(this.planes.filter((function(e){return!e.is("ReconnaissanceAircraft")})),"fighterPower")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tp",{get:function(){return Object(p.a)(this.nonNullableShips,w)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expeditionBonus",{get:function(){return e=this.nonNullableShips,t=e.flatMap((function(e){return e.gears})).filter(d.b),r=t.filter(v),i=e.some((function(e){return 487===e.shipId}))?.05:0,(n=Math.min(Object(p.a)(t,A)+i,.2))+.01*n*(r.length&&Object(p.a)(r,(function(e){return e.star}))/r.length)+function(e){var t,r,i=e.filter((function(e){return 68===e.gearId})).length,n=e.filter((function(e){return 193===e.gearId})).length;return n<=2?.02*n:3===n?null!==(t=[.05,.05,.052,.054,.054][i])&&void 0!==t?t:.054:null!==(r=[.054,.056,.058,.059,.06][i])&&void 0!==r?r:.06}(t);var e,t,r,i,n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aviationDetectionScore",{get:function(){return Object(p.a)(this.planes,(function(e){return e.is("LargeFlyingBoat")?e.gear.los*Math.sqrt(e.slotSize):e.is("ReconnaissanceSeaplane")||e.is("SeaplaneBomber")?e.gear.los*Math.sqrt(Math.sqrt(e.slotSize)):0}))},enumerable:!0,configurable:!0}),e}(),P=function(e){var t=this;this.shipFactory=e,this.create=function(e){var r=e.ships.map(t.shipFactory.create);return new S(r)}},C=function(){function e(e,t,r){var i=this;this.gear=e,this.slots=t,this.index=r,this.contactSelectionRate=function(e){var t=i.gear,r=t.los,n=t.improvement;return Math.ceil(r+n.contactSelectionModifier)/(20-2*e.contactMultiplier)},this.calcNightAerialAttackPower=function(e){void 0===e&&(e=!1);var t=i,r=t.isNightPlane,n=t.isNightAircraft,a=t.gear,o=t.slotSize;if(!n)return 0;var s=a.firepower,c=a.torpedo,u=a.asw,l=a.bombing,f=0,p=.3;r&&(f=3,p=.45);var h=Math.sqrt(a.improvement.value);return s+(e?0:c)+l+f*o+p*(s+c+u+l)*Math.sqrt(o)+h},this.shotdown=function(e){i.slotSize-=e,i.slotSize<0&&(i.slotSize=0)}}return Object.defineProperty(e.prototype,"is",{get:function(){return this.gear.is},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"category",{get:function(){return this.gear.category},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"slotSize",{get:function(){return this.slots[this.index]},set:function(e){this.slots[this.index]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPower",{get:function(){var e=this.gear,t=this.slotSize;return e.calcFighterPower(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptionPower",{get:function(){var e=this.gear,t=this.slotSize;return e.calcFighterPower(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canContact",{get:function(){return this.is("CarrierBasedTorpedoBomber")||this.is("ReconnaissanceAircraft")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contactTriggerFactor",{get:function(){var e=this.gear,t=this.slotSize;return Math.floor(e.los*Math.sqrt(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participatesInAirstrike",{get:function(){return 0!==this.slotSize&&(this.is("DiveBomber")||this.is("TorpedoBomber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"participatesInCarrierShelling",{get:function(){var e=this.category;return 0!==this.slotSize&&e.any("CarrierBasedDiveBomber","CarrierBasedTorpedoBomber","JetPoweredFighterBomber","JetPoweredTorpedoBomber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetLosModifier",{get:function(){var e=this.gear,t=this.slotSize;return this.is("ReconnaissanceSeaplane")||this.is("SeaplaneBomber")?e.los*Math.floor(Math.sqrt(t)):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSwordfish",{get:function(){return this.gear.name.includes("Swordfish")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNightFighter",{get:function(){return 45===this.gear.iconId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNightAttacker",{get:function(){return 46===this.gear.iconId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNightPlane",{get:function(){return this.isNightFighter||this.isNightAttacker},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isNightAircraft",{get:function(){var e=this.isNightPlane,t=this.isSwordfish,r=this.gear;return e||t||[154,320].includes(r.gearId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterCombatResistModifier",{get:function(){return this.is("JetPoweredAircraft")?.6:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"adjustedAntiAirResistModifier",{get:function(){var e=this.gear.gearId;return[93,94,143,144,343,99,100,154,319,320,79,80,81,237,170].includes(e)?.6:[322,323,199,200].includes(e)?.5:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetAntiAirResistModifier",{get:function(){var e=this.gear.gearId;return[100,154,81,237,322,199].includes(e)?.7:[323,200].includes(e)?.5:1},enumerable:!0,configurable:!0}),e}(),O=function(e,t){var r=new Array;return e.map((function(i,n){var a=t[n];i&&a&&a.is("Aircraft")&&r.push(new C(a,e,n))})),r},j=function(e){var t=e.los;return e.is("LandBasedReconnaissanceAircraft")?t<=7?1.12:8===t?1.15:1.18:1},F=function(e){var t=e.los;return e.is("CarrierBasedReconnaissanceAircraft")||e.is("CarrierBasedReconnaissanceAircraft2")?t<=7?1.2:8===t?1.25:1.3:e.is("LandBasedReconnaissanceAircraft")?1.18:e.is("ReconnaissanceSeaplane")||e.is("LargeFlyingBoat")?t<=7?1.1:8===t?1.13:1.16:1},B=function(){function e(e,t){this.slots=e,this.gears=t,this.planes=O(e,t)}return Object.defineProperty(e.prototype,"equipments",{get:function(){return this.gears},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonNullableGears",{get:function(){return this.gears.filter(d.b)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPlanes",{get:function(){return this.nonNullableGears.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPower",{get:function(){if(!this.hasPlanes)return 0;var e=Object(p.a)(this.planes,(function(e){return e.fighterPower})),t=Math.max.apply(Math,this.nonNullableGears.map(j));return Math.floor(e*t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptionPower",{get:function(){if(!this.hasPlanes)return 0;var e=Object(p.a)(this.planes,(function(e){return e.interceptionPower})),t=Math.max.apply(Math,this.nonNullableGears.map(F));return Math.floor(e*t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minCombatRadius",{get:function(){return this.hasPlanes?Math.min.apply(Math,this.nonNullableGears.map((function(e){return e.radius}))):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"combatRadius",{get:function(){if(!this.hasPlanes)return 0;var e=this.minCombatRadius,t=this.nonNullableGears,r=Math.max.apply(Math,t.map((function(e){return e.is("ReconnaissanceAircraft")?e.radius:0})));if(r>0){var i=Math.min(Math.sqrt(r-e),3);return Math.round(e+i)}return e},enumerable:!0,configurable:!0}),e}(),k=function(e){var t=this;this.gearFactory=e,this.create=function(e){var r=e.equipments,i=e.slots.concat(),n=r.map(t.gearFactory.create);return new B(i,n)}},I=r(4113),T=function(){function e(e,t,r,i){var n=this;this.side=e,this.fleetType=t,this.fleets=r,this.landBase=i,this.getFighterPower=function(e){void 0===e&&(e=!1);var t=n,r=t.mainFleet,i=t.escortFleet;if(!r.hasUnknownSlot){if(!e||!i)return r.fighterPower;if(!i.hasUnknownSlot)return r.fighterPower+i.fighterPower}},this.getInterceptionPower=function(e){void 0===e&&(e=!1);var t=n,r=t.mainFleet,i=t.escortFleet;if(!r.hasUnknownSlot){var a=Object(p.a)(r.planes,(function(e){return e.interceptionPower}));if(!e||!i)return a;if(!i.hasUnknownSlot)return a+Object(p.a)(i.planes,(function(e){return e.interceptionPower}))}}}return Object.defineProperty(e.prototype,"isCombinedFleetOperation",{get:function(){return this.fleetType!==I.a.Single},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mainFleet",{get:function(){return this.fleets[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"escortFleet",{get:function(){if(this.isCombinedFleetOperation)return this.fleets[1]},enumerable:!0,configurable:!0}),e}(),R=function(){function e(e,t){this.fleetFactory=e,this.landBasedAirCorpsFactory=t}return e.prototype.create=function(e){var t=e.side,r=e.fleetType,i=e.fleets,n=e.landBase,a=i.map(this.fleetFactory.create),o=n.map(this.landBasedAirCorpsFactory.create);return new T(t,r,a,o)},e}(),D=r(3483),G=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.map((function(e){return D.a[e]})).includes(t.shipClassId)}},L=G("QueenElizabethClass","NelsonClass","ArkRoyalClass","JClass"),q=G("JohnCButlerClass","FletcherClass","IowaClass","LexingtonClass","EssexClass","CasablancaClass","ColoradoClass","NorthamptonClass","AtlantaClass"),E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return e.some((function(e){return e(t)}))}}((function(e){return 147===e.shipId}),G("TashkentClass","GangutClass")),N=G("AirfieldPrincess","NorthernPrincess","HarbourPrincess","SupplyDepotPrincess","SupplyDepotSummerPrincess"),x=G("ArtilleryImp"),z=G("IsolatedIslandDemon","IsolatedIslandPrincess"),H={RoyalNavy:L,UsNavy:q,SovietNavy:E,Installation:function(e){return 0===e.speed},SoftSkinned:N,Pillbox:x,SupplyDepot:G("SupplyDepotPrincess","SupplyDepotSummerPrincess"),IsolatedIsland:z,Unremodeled:function(e){return e.sortId%10==1},Kai:function(e){return e.name.endsWith("改")},Kai2:function(e){return e.sortId%10>=6&&e.sortId%10<9}},K=Object.keys(H),_={from:function(e){return K.filter((function(t){return H[t](e)}))}},V=function(){function e(e,t){var r=this;this.maxHp=e,this.currentHp=t,this.gte=function(e){var t=r.currentHp/r.maxHp;switch(e){case"Less":return t>=1;case"Shouha":return t>=.75;case"Chuuha":return t>=.5;case"Taiha":return t>=.25}return!0},this.lte=function(e){return e===r.damage||!r.gte(e)}}return Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.currentHp/this.maxHp;return e<=0?"Sunk":e<=.25?"Taiha":e<=.5?"Chuuha":e<=.75?"Shouha":"Less"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shellingPowerModifier",{get:function(){switch(this.damage){case"Less":case"Shouha":return 1;case"Chuuha":return.7;case"Taiha":return.4}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedoPowerModifier",{get:function(){switch(this.damage){case"Less":case"Shouha":return 1;case"Chuuha":return.8}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aswPowerModifier",{get:function(){return this.shellingPowerModifier},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nightAttackPowerModifier",{get:function(){return this.lte("Taiha")?0:this.shellingPowerModifier},enumerable:!0,configurable:!0}),e}(),J={Sparkling:1.2,Normal:1,Orange:.8,Red:.5},U={accuracy:{shelling:J,asw:J,torpedo:{Sparkling:1.3,Normal:1,Orange:.7,Red:.35},night:J},evasion:{Sparkling:.7,Normal:1,Orange:1.2,Red:1.4}},Y=function(){function e(e){var t=this;void 0===e&&(e=49),this.value=e,this.getAccuracyModifier=function(e){return U.accuracy[e][t.state]}}return Object.defineProperty(e.prototype,"state",{get:function(){var e=this.value;return e>=50?"Sparkling":e>=30?"Normal":e>=20?"Orange":"Red"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasionModifier",{get:function(){return U.evasion[this.state]},enumerable:!0,configurable:!0}),e}(),$=r(4164),Z=r(3487),Q=r(3489),W=r(537),X=r(608),ee=r(49),te=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i},re={attrs:"Installation"},ie={attrs:"Pillbox"},ne={attrs:"IsolatedIsland"},ae={attrs:"SoftSkinned"},oe={shipClassId:D.a.HarbourSummerPrincess},se={attrs:"SupplyDepot"},ce=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{$or:te(e)}},ue=[{gear:{categoryId:c.a.AntiAircraftShell},rules:[{target:ce(ne,oe),count1:{a13:1.75}},{target:ae,count1:{a13:2.5}}]},{gear:{categoryId:c.a.ArmorPiercingShell},rules:[{target:ie,count1:{a13:1.85}},{target:oe,count1:{a13:1.3}}]},{gear:126,rules:[{target:ie,count1:{a13:1.6},count2:{a13:2.72}},{target:ne,count1:{a13:1.4},count2:{a13:2.1}},{target:ae,count1:{a13:1.3},count2:{a13:1.82}},{target:oe,count1:{a13:1.4},count2:{a13:1.68}},{target:se,count1:{a5:1.25},count2:{a5:1.625}},{target:re,count1:{b13next:75},count2:{b13next:110},count3:{b13next:140},count4:{b13next:160}}]},{gear:{attrs:"AntiGroundRocketLauncher"},rules:[{target:ie,count1:{a13:1.5},count2:{a13:2.7}},{target:ne,count1:{a13:1.3},count2:{a13:2.145}},{target:ae,count1:{a13:1.25},count2:{a13:1.875}},{target:oe,count1:{a13:1.25},count2:{a13:1.75}},{target:se,count1:{a5:1.2},count2:{a5:1.68}}]},{gear:348,rules:[{target:re,count1:{b13next:55},count2:{b13next:115},count3:{b13next:160},count4:{b13next:190}}]},{gear:349,rules:[{target:re,count1:{b13next:80},count2:{b13next:170}}]},{gear:{attrs:"Mortar"},rules:[{target:ie,count1:{a13:1.3},count2:{a13:1.95}},{target:ne,count1:{a13:1.2},count2:{a13:1.68}},{target:ae,count1:{a13:1.2},count2:{a13:1.56}},{target:oe,count1:{a13:1.1},count2:{a13:1.265}},{target:se,count1:{a5:1.15},count2:{a5:1.38}}]},{gear:346,rules:[{target:re,count1:{b13next:30},count2:{b13next:55},count3:{b13next:75},count4:{b13next:90}}]},{gear:347,rules:[{target:re,count1:{b13next:60},count2:{b13next:110},count3:{b13next:150},count4:{b13next:180}}]},{gear:{categoryId:c.a.LandingCraft},rules:[{target:ce(ie,ne),count1:{a13:1.8}},{target:ae,count1:{a13:1.4}},{target:oe,count1:{a13:1.7}},{target:se,count1:{a5:1.7}}]},{gear:193,rules:[{target:ce(ie,ne,ae),count1:{a13:1.15}},{target:oe,count1:{a13:1.2}},{target:se,count1:{a5:1.2}}]},{gear:166,rules:[{target:ie,count1:{a13:1.5},count2:{a13:2.1}},{target:ne,count1:{a13:1.2},count2:{a13:1.68}},{target:ae,count1:{a13:1.5},count2:{a13:1.95}},{target:oe,count1:{a13:1.6},count2:{a13:2.4}},{target:se,count1:{a5:1.3},count2:{a5:2.08}}]},{gear:230,rules:[{target:re,count1:{a13:1.8,b13:25}}]},{gear:355,rules:[{target:ie,count1:{a13:2}},{target:ne,count1:{a13:1.8}},{target:ae,count1:{a13:1.1}},{target:oe,count1:{a13:2}},{target:se,count1:{a5:1.2}},{target:re,count1:{b13:25,a13next:1.4}}]},{gear:167,rules:[{target:ce(ie,ne),count1:{a13:2.4},count2:{a13:3.24}},{target:ae,count1:{a13:1.5},count2:{a13:1.8}},{target:oe,count1:{a13:2.8},count2:{a13:4.2}},{target:se,count1:{a5:1.7},count2:{a5:2.55}}]},{gear:{categoryId:c.a.CarrierBasedDiveBomber},rules:[{target:ie,count1:{a13:1.5},count2:{a13:3}},{target:ne,count1:{a13:1.4},count2:{a13:2.45}},{target:oe,count1:{a13:1.3}}]},{gear:{categoryId:{$in:[c.a.SeaplaneBomber,c.a.SeaplaneFighter]}},rules:[{target:ie,count1:{a13:1.5}},{target:ae,count1:{a13:1.2}},{target:oe,count1:{a13:1.3}}]},{ship:{shipTypeId:{$in:[y.a.Destroyer,y.a.LightCruiser]}},target:ie,bonus:{a13:1.4}},{ship:{shipTypeId:{$in:[y.a.Submarine,y.a.SubmarineAircraftCarrier]}},target:re,bonus:{b12:30}}],le=function(e,t){var r=e.countGear("LandingCraft"),i={};if(r){var n=e.totalEquipmentStats((function(e){return e.is("LandingCraft")?e.star:0}));if(i.a13=1+n/r/50,!t)return i;i.a5=i.a13,e.hasGear(166)&&(i.a5*=i.a5)}return i},fe=function(e,t){var r=e.countGear(167),i={};if(r){var n=e.totalEquipmentStats((function(e){return e.match(167)?e.star:0}));if(i.a13=1+n/r/30,!t)return i;i.a5=i.a13}return i},pe=function(e,t){var r=function(e,t){var r=function(i,n){void 0===n&&(n=0);var a=[];if(!function(e,t,r){var i=e.ship,n=e.target;return!(i&&!t.match(i))&&!(n&&!r.match(n))}(i,e,t))return a;var o=i.gear,s=i.bonus,c=i.rules,u=o?e.countGear((function(e){return e.match(o)})):n;return u&&a.push(function(e,t){var r=e.count1,i=e.count2,n=e.count3,a=e.count4,o=e.count5,s={};return[r,i,n,a,o].forEach((function(e,r){e&&t>r&&(s=e)})),s}(i,u)),s&&a.push(s),c&&a.push.apply(a,c.flatMap((function(e){return r(e,u)}))),a};return r}(e,t),i=ue.flatMap((function(e){return r(e)})),n=function(e,t){if(!t.isInstallation)return[];var r=t.is("SupplyDepot");return[le(e,r),fe(e,r)]}(e,t);return ee.a.apply(void 0,te(i,n))},he=function(){return(he=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},de=function(){function e(e,t,r,i,n,a,s,c,u){var l=this;this.master=e,this.stats=t,this.nakedStats=r,this.health=i,this.morale=n,this.slots=a,this.gears=s,this.planes=c,this.attrs=u,this.is=function(e){return l.attrs.includes(e)},this.canEquip=function(e,t){var r=l,i=r.shipId,n=r.shipClass,a=l.master,o=a.equippable,s=a.isAbyssal,c=e.gearId,u=e.categoryId;if(s)return!0;if(!o.categories.includes(u))return!1;if([492,392].includes(i)&&e.is("SeaplaneBomber"))return 194===c;if(l.is("RoyalNavy")&&l.shipType.isBattleshipClass&&e.is("SeaplaneBomber"))return[367,368].includes(c);if(l.slots.length<=t){return $.a.includes(u)||o.expantionSlot.includes(c)||33===c}if(n.is("IseClass")&&l.is("Kai2"))return!(t>1&&e.is("MainGun"));if(n.is("YuubariClass")&&l.is("Kai2")){if(t>=3&&(e.is("MainGun")||e.is("Torpedo")||e.is("MidgetSubmarine")))return!1;if(4===t)return e.is("AntiAircraftGun")||e.is("SmallRadar")||e.is("CombatRation")}return!0},this.match=function(e){return"number"==typeof e?l.shipId===e:o()(e)(l)},this.hasGear=function(e){var t=l.nonNullableGears;return"string"==typeof e?t.some((function(t){return t.is(e)})):"number"==typeof e?t.some((function(t){return t.gearId===e})):t.some(e)},this.countGear=function(e){var t=l.nonNullableGears;return void 0===e?t.length:"string"==typeof e?t.filter((function(t){return t.is(e)})).length:"number"==typeof e?t.filter((function(t){return t.gearId===e})).length:t.filter(e).length},this.totalEquipmentStats=function(e){return Object(p.a)(l.nonNullableGears,e)},this.getDefensePower=function(){var e=l.stats.armor+l.totalEquipmentStats((function(e){return e.improvement.defensePowerModifier})),t=.7*Math.max(e,1),r=t+.6*Math.floor(e-1);return{min:t,max:r,values:function(){return Object(Z.a)(Math.floor(e)).map((function(e){return t+.6*e}))},random:function(){return t+.6*Object(Q.a)(Math.floor(e-1))}}},this.getCruiserFitBonus=function(){var e=l,t=e.shipType,r=e.shipClass,i=e.countGear,n=t.any("LightCruiser","TorpedoCruiser","TrainingCruiser"),a=r.is("ZaraClass"),o=i((function(e){return[4,11].includes(e.gearId)})),s=i((function(e){return[65,119,139].includes(e.gearId)}));return Object(W.a)({isLightCruiserClass:n,singleGunCount:o,twinGunCount:s,isZaraClass:a,zaraGunCount:Math.sqrt(i(162))})},this.getRemainingPlanes=function(){return l.planes.filter(d.b)},this.getNormalProficiencyModifiers=function(){var e={power:1,hitRate:0,criticalRate:0};if("CarrierShelling"!==l.getShellingType())return e;var t=l.getRemainingPlanes().filter((function(e){return e.is("DiveBomber")||e.is("TorpedoBomber")||e.is("LargeFlyingBoat")}));e.power=1+Object(p.a)(t,(function(e){return 0===e.index?e.gear.proficiency.criticalPowerModifier/100:e.gear.proficiency.criticalPowerModifier/200}));var r=Object(p.a)(t,(function(e){return e.gear.proficiency.internal}))/t.length,i=0,n=0;return r>=10&&(i=Math.floor(Math.sqrt(.1*r))),r>=25&&(n=1),r>=40&&(n=2),r>=55&&(n=3),r>=70&&(n=4),r>=80&&(n=6),r>=100&&(n=9),e.hitRate=i+n,e.criticalRate=Object(p.a)(t,(function(e){var t=e.gear.proficiency,r=t.internal,i=t.level,n=0===e.index?10:0,a=(Math.sqrt(.1*r)+i)/2;return Math.floor(a+n)/100})),e},this.getSpecialProficiencyModifiers=function(){var e={power:1,hitRate:0,criticalRate:0};return"CarrierShelling"!==l.getShellingType()||(l.getRemainingPlanes().filter((function(e){return e.participatesInCarrierShelling&&120===e.gear.proficiency.internal})).some((function(e){return 0===e.index}))?e.power=1.25:e.power=1.106),e},this.getSpecialEnemyModifiers=function(e){return pe(l,e)},this.getAntiInstallationModifier=function(e){var t=l.getSpecialEnemyModifiers(e);return he(he({},{a13:1,a13next:1,a5:1,b12:0,b13:0,b13next:0}),t)},this.calcEvasionValue=function(e,t){var r=l.stats,i=r.evasion,n=r.luck,a=l.totalEquipmentStats((function(e){return e.is("EngineImprovement")?e.star:0})),o=Math.floor(1.5*Math.sqrt(a));return Object(X.a)({evasion:i,luck:n,improvementModifier:o,formationModifier:e,postcapModifier:t})},this.slotCapacities=e.slotCapacities.concat()}return Object.defineProperty(e.prototype,"shipId",{get:function(){return this.master.shipId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shipClassId",{get:function(){return this.master.shipClassId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shipTypeId",{get:function(){return this.master.shipType.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remodelGroup",{get:function(){return this.master.remodelGroup},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rank",{get:function(){return this.master.sortId%10},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equipments",{get:function(){return this.gears},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"masterId",{get:function(){return this.master.shipId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.master.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ruby",{get:function(){return this.master.readingName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shipClass",{get:function(){return this.master.shipClass},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shipType",{get:function(){return this.master.shipType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this.nakedStats.level},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shipAccuracy",{get:function(){var e=this.nakedStats,t=e.level,r=e.luck;return 2*Math.sqrt(t)+1.5*Math.sqrt(r)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPower",{get:function(){return Object(p.a)(this.planes.filter((function(e){var t=e.gear;return t.is("Fighter")||t.is("TorpedoBomber")||t.is("DiveBomber")})),"fighterPower")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetLosFactor",{get:function(){return this.nakedStats.los+Object(p.a)(this.planes,(function(e){return e.fleetLosModifier}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInstallation",{get:function(){return 0===this.nakedStats.speed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"installationType",{get:function(){var e=this.isInstallation,t=this.name;return e?t.includes("砲台")?"Pillbox":t.includes("離島")||t.includes("中枢")?"IsolatedIsland":t.includes("集積")?"SupplyDepot":"SoftSkinned":"None"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonNullableGears",{get:function(){return this.gears.filter(d.b)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canNightAttack",{get:function(){var e=this.shipClass,t=(this.shipType,this.health),r=this.master;return!t.lte("Taiha")&&(e.is("ArkRoyalClass")?"Chuuha"!==t.damage&&this.planes.some((function(e){return e.isSwordfish})):r.firepower[0]>0)},enumerable:!0,configurable:!0}),e.prototype.getShellingType=function(){var e=this.shipType,t=this.shipClass,r=this.isInstallation,i=this.hasGear;return e.isAircraftCarrierClass||(t.is("RevisedKazahayaClass")||r)&&(i("DiveBomber")||i("TorpedoBomber"))?"CarrierShelling":"Shelling"},e}(),ge=r(536),me=r(4123),be=r(607),ye=(r(4252),r(3432)),ve=r(4163),Ae=["firepower","armor","torpedo","accuracy","evasion","antiAir","asw","speed","los","range","speed","effectiveLos"],Me=function(e,t){for(var r={},i=0,n=Ae;i<n.length;i++){var a=n[i],o=(e[a]||0)+(t[a]||0);0!==o&&(r[a]=o)}return r},we=function(e){var t,r=[0,0,(t=e.categoryId,38===t?3:93===t?13:94===t?9:t),e.iconId,0];return{accuracy:e.accuracy,antiAir:e.antiAir,armor:e.armor,asw:e.asw,bombing:e.bombing,evasion:e.evasion,firepower:e.firepower,gearId:e.gearId,los:e.los,name:e.name,radius:e.radius,range:e.range,torpedo:e.torpedo,ace:e.proficiency.level,stars:e.improvement.value,types:r,specialType2:e.categoryId}},Se=function(e,t){var r={shipId:e.shipId,stype:e.shipTypeId,ctype:e.shipClassId,yomi:e.ruby},i=t.filter(d.b).map(we);return Object(ye.createEquipmentBonuses)(r,i)},Pe=function(e){var t=e.gears.filter((function(e){return e&&function(e){return!e.is("SmallRadar")}(e)}));return Se(e,t).los},Ce=function(e){var t=Se(e,e.gears),r=function(e){if(!e.hasGear(33))return{};var t=ve.a.getSpeedGroup(e),r=e.countGear(34),i=e.countGear(87),n=ve.a.getSpeedIncrement(t,r,i);return n>0?{speed:n}:e.shipClassId===D.a.JohnCButlerClass||623===e.shipId?{speed:5}:{}}(e);return[{effectiveLos:Pe(e)},r].reduce(Me,t)},Oe=function(){function e(e,t,r){var i=this;void 0===r&&(r={}),this.nakedStats=e,this.gears=t,this.equipmentBonus=r,this.getBonus=function(e){var t=i.equipmentBonus;return Object(be.a)(Ae,e)&&t[e]||0}}return e.prototype.getStat=function(e){var t=this.nakedStats,r=this.gears;return t[e]+Object(p.a)(r.filter(d.b),e)+this.getBonus(e)},Object.defineProperty(e.prototype,"hp",{get:function(){return this.nakedStats.hp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firepower",{get:function(){return this.getStat("firepower")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedo",{get:function(){return this.getStat("torpedo")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAir",{get:function(){return this.getStat("antiAir")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"armor",{get:function(){return this.getStat("armor")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"los",{get:function(){return this.getStat("los")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asw",{get:function(){return this.getStat("asw")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){return this.getStat("evasion")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"luck",{get:function(){return this.nakedStats.luck},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.getStat("speed")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){var e=this.nakedStats,t=this.gears,r=this.getBonus,i=e.range,n=Object(me.a)(t,"range");return(n&&n.range>i?n.range:i)+r("range")},enumerable:!0,configurable:!0}),e}(),je=function(e,t){var r=this;this.masters=e,this.gearFactory=t,this.gearsFrom=function(e,t){return e?e.map(r.gearFactory.create):t.isAbyssal?t.initialEquipment.map((function(e){var t=e.id,i=e.improvement;return r.gearFactory.create({masterId:t,improvement:i})})):[]},this.create=function(e){if(e){var t=e.masterId,i=e.level,n=void 0===i?1:i,a=e.increased,o=e.morale,s=r.masters.find((function(e){return e.shipId===t}));if(s){var c=r.gearsFrom(e.equipments,s),u=new ge.a(s,n,a),l=new Oe(u,c),f=e.currentHp,p=void 0===f?l.hp:f,h=new V(l.hp,p),d=new Y(o),g=e.slots?e.slots.concat():s.slotCapacities.concat(),m=O(g,c),b=_.from(s),y=new de(s,l,u,h,d,g,c,m,b);return y.stats.equipmentBonus=Ce(y),y}}}},Fe=function(){function e(e){void 0===e&&(e=new i.a),this.masterData=e,this.gearFactory=new f(e.gears),this.shipFactory=new je(e.ships,this.gearFactory),this.fleetFactory=new P(this.shipFactory),this.landBasedAirCorpsFactory=new k(this.gearFactory),this.operationFactory=new R(this.fleetFactory,this.landBasedAirCorpsFactory)}return Object.defineProperty(e.prototype,"createOperation",{get:function(){return this.operationFactory.create},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createFleet",{get:function(){return this.fleetFactory.create},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createLandBasedAirCorps",{get:function(){return this.landBasedAirCorpsFactory.create},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createShip",{get:function(){return this.shipFactory.create},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createGear",{get:function(){return this.gearFactory.create},enumerable:!0,configurable:!0}),e}();t.a=Fe},4113:function(e,t,r){"use strict";var i;!function(e){e.Single="Single",e.CarrierTaskForce="CarrierTaskForce",e.SurfaceTaskForce="SurfaceTaskForce",e.TransportEscort="TransportEscort",e.Combined="Combined"}(i||(i={})),t.a=i},4120:function(e,t,r){"use strict";var i;!function(e){e.NormalBattle="NormalBattle",e.NightBattle="NightBattle",e.NightToDayBattle="NightToDayBattle",e.AerialBattle="AerialBattle",e.AirDefenseBattle="AirDefenseBattle"}(i||(i={})),t.a=i},4163:function(e,t,r){"use strict";var i;!function(e){e[e.FastA=0]="FastA",e[e.FastB1SlowA=1]="FastB1SlowA",e[e.FastB2SlowB=2]="FastB2SlowB",e[e.OtherC=3]="OtherC"}(i||(i={}));var n=function(){function e(t,r){var i=this;this.value=t,this.name=r,this.add=function(t){return e.fromNumber(i.value+t)}}return e.getSpeedGroup=function(t){var r=t.shipType,n=t.shipClass,a=t.shipId,o=t.remodelGroup;return e.fromNumber(t.nakedStats.speed)===e.Fast&&r.is("SeaplaneTender")||r.isSubmarineClass||[115,293].includes(a)||["加賀型","特種船丙型","工作艦","改風早型"].includes(n.name)?i.OtherC:["島風型","Ташкент級","大鳳型","翔鶴型","利根型","最上型"].includes(n.name)?i.FastA:["阿賀野型","蒼龍型","飛龍型","金剛型","大和型","Iowa級"].includes(n.name)||181===o||404===o||331===o||541===a?i.FastB1SlowA:i.FastB2SlowB},e.getSpeedIncrement=function(e,t,r){var n=t+r;switch(e){case i.FastA:if(r>=1||n>=2)return 10;break;case i.FastB1SlowA:if(0===r)break;if(n>=3)return 15;if(n>=2)return 10;break;case i.FastB2SlowB:if(r>=2||n>=3)return 10}return n>=1?5:0},e}();t.a=n,n.Land=new n(0,"陸上"),n.Slow=new n(5,"低速"),n.Fast=new n(10,"高速"),n.FastPlus=new n(15,"高速+"),n.Fastest=new n(20,"最速"),n.fromNumber=function(e){var t=[n.Land,n.Slow,n.Fast,n.FastPlus,n.Fastest].find((function(t){return e<=t.value}));return t||n.Fastest}},4168:function(e,t,r){"use strict";var i=r(365),n=r(3489),a=function(){function e(t,r,i,n){this.id=t,this.name=r,this.typeFactor=i,this.modifier=n,e.all.push(this)}return Object.defineProperty(e.prototype,"api",{get:function(){return Math.floor(this.id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCarrierSpecialAttack",{get:function(){return 7===this.api},enumerable:!0,configurable:!0}),e}();t.a=a,a.all=[],a.MainMain=new a(6,"主主",150,{power:1.5,accuracy:1.2}),a.MainApShell=new a(5,"主徹",140,{power:1.3,accuracy:1.3}),a.MainRader=new a(4,"主電",130,{power:1.2,accuracy:1.5}),a.MainSecond=new a(3,"主副",120,{power:1.1,accuracy:1.3}),a.DoubleAttack=new a(2,"連撃",130,{power:1.2,accuracy:1.1}),a.FighterBomberAttacker=new a(7.1,"FBA",125,{power:1.25,accuracy:1}),a.BomberBomberAttacker=new a(7.2,"BBA",140,{power:1.2,accuracy:1}),a.BomberAttacker=new a(7.3,"BA",155,{power:1.15,accuracy:1}),a.getPossibleAircraftCarrierCutins=function(e){var t=new Array,r=e.planes.filter((function(e){return e.slotSize>0})),i=r.filter((function(e){return e.is("CarrierBasedDiveBomber")})).length,n=r.some((function(e){return e.is("CarrierBasedTorpedoBomber")}));return 0!==i&&n?(t.push(a.BomberAttacker),i>=2&&t.push(a.BomberBomberAttacker),r.some((function(e){return e.is("CarrierBasedFighterAircraft")}))&&t.push(a.FighterBomberAttacker),t.sort((function(e,t){return e.typeFactor-t.typeFactor}))):t},a.getPossibleArtillerySpottings=function(e){var t=new Array,r=e.planes.some((function(e){return e.slotSize>0&&e.is("ReconnaissanceSeaplane")||e.is("SeaplaneBomber")})),i=e.countGear((function(e){return e.is("MainGun")}));if(!r||0===i)return t;var n=e.hasGear((function(e){return e.is("ArmorPiercingShell")})),o=e.hasGear((function(e){return e.is("SecondaryGun")})),s=e.hasGear((function(e){return e.is("Radar")}));return i>=2&&(t.push(a.DoubleAttack),n&&t.push(a.MainMain)),o&&(t.push(a.MainSecond),s&&t.push(a.MainRader),n&&t.push(a.MainApShell)),t.sort((function(e,t){return t.id-e.id}))},a.getPossibleAttacks=function(e,t){return void 0===t&&(t=!1),"Taiha"===e.health.damage?[]:e.shipType.isAircraftCarrierClass&&!t?a.getPossibleAircraftCarrierCutins(e):a.getPossibleArtillerySpottings(e)},a.calcFleetLosModifier=function(e){var t=e.totalShipStats((function(e){return e.fleetLosFactor}));return Math.floor(Math.sqrt(t)+.1*t)},a.calcBaseValue=function(e,t,r,n){var a=e.stats.luck,o=Math.floor(Math.sqrt(a)+10),s=e.totalEquipmentStats("los"),c=n?15:0;return r===i.a.AirSupremacy?Math.floor(o+.7*(t+1.6*s)+10)+c:r===i.a.AirSuperiority?Math.floor(o+.6*(t+1.2*s))+c:0},a.calcRate=function(e,t,r,i){var n=a.calcBaseValue(e,t,r,i),o=new Map,s=a.getPossibleAttacks(e),c=s.reduce((function(e,t){var r=(1-e)*(n/t.typeFactor);return r>1&&(r=1),o.set(t,r),e+r}),0),u=1-c,l=u<=0,f=s.concat();l||f.unshift(void 0);var p=function(e){return e?o.get(e)||0:u};return{baseValue:n,attacks:s,rateMap:o,total:c,dayCombatAttacks:f,getAttackRate:p,entries:function(){return f.map((function(e){return[e,p(e)]}))}}},a.try=function(e,t,r,i){for(var o=a.calcBaseValue(e,t,r,i),s=0,c=a.getPossibleAttacks(e);s<c.length;s++){var u=c[s];if(o>Object(n.a)(u.typeFactor-1))return u}}},42:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i,n=r(4112);!function(e){e[e.SmallCaliberMainGun=1]="SmallCaliberMainGun",e[e.MediumCaliberMainGun=2]="MediumCaliberMainGun",e[e.LargeCaliberMainGun=3]="LargeCaliberMainGun",e[e.SecondaryGun=4]="SecondaryGun",e[e.Torpedo=5]="Torpedo",e[e.CarrierBasedFighterAircraft=6]="CarrierBasedFighterAircraft",e[e.CarrierBasedDiveBomber=7]="CarrierBasedDiveBomber",e[e.CarrierBasedTorpedoBomber=8]="CarrierBasedTorpedoBomber",e[e.CarrierBasedReconnaissanceAircraft=9]="CarrierBasedReconnaissanceAircraft",e[e.ReconnaissanceSeaplane=10]="ReconnaissanceSeaplane",e[e.SeaplaneBomber=11]="SeaplaneBomber",e[e.SmallRadar=12]="SmallRadar",e[e.LargeRadar=13]="LargeRadar",e[e.Sonar=14]="Sonar",e[e.DepthCharge=15]="DepthCharge",e[e.ExtraArmor=16]="ExtraArmor",e[e.EngineImprovement=17]="EngineImprovement",e[e.AntiAircraftShell=18]="AntiAircraftShell",e[e.ArmorPiercingShell=19]="ArmorPiercingShell",e[e.VTFuze=20]="VTFuze",e[e.AntiAircraftGun=21]="AntiAircraftGun",e[e.MidgetSubmarine=22]="MidgetSubmarine",e[e.EmergencyRepairPersonnel=23]="EmergencyRepairPersonnel",e[e.LandingCraft=24]="LandingCraft",e[e.Autogyro=25]="Autogyro",e[e.AntiSubmarinePatrolAircraft=26]="AntiSubmarinePatrolAircraft",e[e.MediumExtraArmor=27]="MediumExtraArmor",e[e.LargeExtraArmor=28]="LargeExtraArmor",e[e.Searchlight=29]="Searchlight",e[e.SupplyTransportContainer=30]="SupplyTransportContainer",e[e.ShipRepairFacility=31]="ShipRepairFacility",e[e.SubmarineTorpedo=32]="SubmarineTorpedo",e[e.StarShell=33]="StarShell",e[e.CommandFacility=34]="CommandFacility",e[e.AviationPersonnel=35]="AviationPersonnel",e[e.AntiAircraftFireDirector=36]="AntiAircraftFireDirector",e[e.AntiGroundEquipment=37]="AntiGroundEquipment",e[e.LargeCaliberMainGun2=38]="LargeCaliberMainGun2",e[e.SurfaceShipPersonnel=39]="SurfaceShipPersonnel",e[e.LargeSonar=40]="LargeSonar",e[e.LargeFlyingBoat=41]="LargeFlyingBoat",e[e.LargeSearchlight=42]="LargeSearchlight",e[e.CombatRation=43]="CombatRation",e[e.Supplies=44]="Supplies",e[e.SeaplaneFighter=45]="SeaplaneFighter",e[e.SpecialAmphibiousTank=46]="SpecialAmphibiousTank",e[e.LandBasedAttackAircraft=47]="LandBasedAttackAircraft",e[e.LandBasedFighter=48]="LandBasedFighter",e[e.LandBasedReconnaissanceAircraft=49]="LandBasedReconnaissanceAircraft",e[e.TransportationMaterial=50]="TransportationMaterial",e[e.SubmarineEquipment=51]="SubmarineEquipment",e[e.LargeLandBasedAircraft=53]="LargeLandBasedAircraft",e[e.JetPoweredFighter=56]="JetPoweredFighter",e[e.JetPoweredFighterBomber=57]="JetPoweredFighterBomber",e[e.JetPoweredTorpedoBomber=58]="JetPoweredTorpedoBomber",e[e.JetPoweredReconnaissanceAircraft=59]="JetPoweredReconnaissanceAircraft",e[e.LargeRadar2=93]="LargeRadar2",e[e.CarrierBasedReconnaissanceAircraft2=94]="CarrierBasedReconnaissanceAircraft2"}(i||(i={}));var a=function(){function e(e,t){var r=this;this.id=e,this.name=t,this.is=function(e){return r.id===i[e]},this.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.some(r.is)}}return e.find=function(t,r){128===r||281===r?t=i.LargeCaliberMainGun2:142===r?t=i.LargeRadar2:151===r&&(t=i.CarrierBasedReconnaissanceAircraft2);var n=e.all.find((function(e){return e.id===t}));if(n)return n;var a=new e(t,"");return this.all.push(a),a},e}();t.b=a,a.keyToId=function(e){return i[e]},a.numberToKey=function(e){var t=i[e];if(void 0!==t)return t},a.all=n.a.map((function(e){var t=e.api_id,r=e.api_name;return new a(t,r)}))},4213:function(e,t,r){"use strict";var i;!function(e){e[e.None=1501]="None",e[e.Pillbox=1665]="Pillbox",e[e.IsolatedIsland=1668]="IsolatedIsland",e[e.SoftSkinned=1581]="SoftSkinned",e[e.HarbourSummerPrincess=1699]="HarbourSummerPrincess",e[e.SupplyDepot=1655]="SupplyDepot"}(i||(i={})),t.a=i},4214:function(e,t,r){"use strict";var i=r(241),n=r(98),a=r(162),o=r(49),s=r(364),c=r(240),u=function(){function e(e){var t=e.battleState,r=e.attacker,i=e.defender,n=e.specialAttack,a=e.isCritical,o=e.remainingAmmoModifier,s=e.fitGunBonus,u=e.optionalPowerModifiers;this.battleState=t,this.attacker=r,this.defender=i,this.specialAttack=n,this.isCritical=a,this.remainingAmmoModifier=o,this.fitGunBonus=s,this.optionalPowerModifiers=u,this.attackCalculator=new c.a(r.ship)}return Object.defineProperty(e.prototype,"isArmorPiercing",{get:function(){var e=this.defender.ship.shipType;return e.isBattleshipClass||e.isHeavyCruiserClass||e.any("AircraftCarrier","ArmoredAircraftCarrier")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proficiencyModifiers",{get:function(){var e;return this.attackCalculator.getProficiencyModifiers(null===(e=this.specialAttack)||void 0===e?void 0:e.isCarrierSpecialAttack)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fleetFactors",{get:function(){var e=this.attacker,t=this.defender;return{power:Object(i.c)(e,t),accuracy:Object(i.b)(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){var e=this,t=e.battleState,r=e.attacker,i=e.defender,n=e.fleetFactors,a=e.specialAttack,s=e.isCritical,c=e.isArmorPiercing,u=e.optionalPowerModifiers,l=t.engagement,f=r.role,p=r.formation.getModifiers(f).shelling.power,h=l.modifier,d=r.ship.getSpecialEnemyModifiers(i.ship),g=i.ship.isInstallation,m=Object(o.a)(d,u);return this.attackCalculator.calcPower({formationModifier:p,engagementModifier:h,modifiers:m,fleetFactor:n.power,isCritical:s,isAntiInstallation:g,isArmorPiercing:c,specialAttack:a})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){var e=this,t=e.attacker,r=e.defender,i=e.fleetFactors,n=e.isArmorPiercing,a=e.specialAttack,o=e.fitGunBonus,c=void 0===o?0:o,u=t.formation.getModifiers(t.role).shelling.accuracy;s.a.isIneffective(t.formation,r.formation)&&(u=1);var l=a?a.modifier.accuracy:1;return this.attackCalculator.calcAccuracy({fleetFactor:i.accuracy,formationModifier:u,specialAttackModifier:l,isArmorPiercing:n,fitGunBonus:c})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defenderEvasionValue",{get:function(){var e=this.defender,t=e.ship,r=e.formation,i=e.role,n=r.getModifiers(i).shelling.evasion;return t.calcEvasionValue(n)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitRate",{get:function(){var t=this.accuracy,r=this.defender,i=this.defenderEvasionValue,n=r.ship.morale.evasionModifier;return Object(a.b)({accuracy:t,evasion:i,moraleModifier:n,criticalRateMultiplier:e.criticalRateMultiplier,hitRateBonus:this.proficiencyModifiers.hitRate,criticalRateBonus:this.proficiencyModifiers.criticalRate})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defensePower",{get:function(){return this.defender.ship.getDefensePower()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.power,t=this.defender,r=this.remainingAmmoModifier,i=t.ship.getDefensePower();return new n.a(e.postcap,i,t.ship.health.currentHp,r)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taihaRate",{get:function(){var e=this.damage,t=this.defender,r=this.hitRate,i=this.isCritical,n=t.ship.health,a=n.currentHp,o=n.maxHp,s=t.side,c=function(e){return(a-e)/o<=.25},u=function(e){return 0===e.length?0:e.filter(c).length/e.length},l=e.scratchDamageProbability,f=e.scratchDamages,p=e.deadlyDamageProbability,h=e.stopperDamages,d="Player"===s?p:0,g=e.values.filter((function(e){return!(e<=0)&&!("Player"===s&&a-e<=0)})),m=g.length/e.values.length*u(g)+l*u(f)+d*u(h);return i?r.criticalRate*m:r.normalRate*m},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"can",{get:function(){var e=this.attacker,t=this.defender,r=t.ship.isInstallation,i=this.attackCalculator.type,n=e.ship;if("Sunk"===n.health.damage)return!1;if(t.ship.shipType.isSubmarineClass)return!1;if("CarrierShelling"===i){if(n.health.lte("Taiha"))return!1;if(!n.shipType.is("ArmoredAircraftCarrier")&&n.health.lte("Chuuha"))return!1;var a=n.planes.filter((function(e){return e.slotSize>0}));return(!r||!a.some((function(e){return e.is("DiveBomber")&&!e.is("AntiInstallationBomber")})))&&n.planes.some((function(e){return e.participatesInCarrierShelling}))}return!n.shipType.isSubmarineClass||!r||n.hasGear("SpecialAmphibiousTank")},enumerable:!0,configurable:!0}),e}();t.a=u,u.criticalRateMultiplier=1.3},4215:function(e,t,r){"use strict";var i=r(98),n=r(162),a=r(557),o=function(){function e(e){var t=e.battleState,r=e.attacker,i=e.defender,n=e.isCritical,o=e.remainingAmmoModifier,s=void 0===o?1:o;this.battleState=t,this.attacker=r,this.defender=i,this.isCritical=n,this.remainingAmmoModifier=s,this.attackCalculator=new a.a(r.ship)}return Object.defineProperty(e.prototype,"power",{get:function(){var e=this.battleState,t=this.attacker,r=this.defender,i=this.isCritical,n=e.engagement,a=t.formation.shellingSupportModifiers.power,o=n.modifier,s=r.ship.isInstallation;return this.attackCalculator.calcPower({formationModifier:a,engagementModifier:o,isCritical:i,isAntiInstallation:s})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){var e=this.attacker.formation.shellingSupportModifiers.accuracy;return this.attackCalculator.calcAccuracy({formationModifier:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defenderEvasionValue",{get:function(){var e=this.defender,t=e.ship,r=e.formation,i=e.role,n=r.getModifiers(i).shelling.evasion;return t.calcEvasionValue(n)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitRate",{get:function(){var t=this.accuracy,r=this.defender,i=this.defenderEvasionValue,a=r.ship.morale.evasionModifier;return Object(n.b)({accuracy:t,evasion:i,moraleModifier:a,criticalRateMultiplier:e.criticalRateMultiplier})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.power,t=this.defender,r=this.remainingAmmoModifier,n=t.ship.getDefensePower();return new i.a(e.postcap,n,t.ship.health.currentHp,r)},enumerable:!0,configurable:!0}),e}();t.a=o,o.criticalRateMultiplier=1.1},4216:function(e,t,r){"use strict";var i=r(162),n=r(364),a=r(98),o=r(559),s=function(){return(s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},c=function(){function e(e){var t=this,r=e.attacker,i=e.defender,a=e.engagement,c=e.isCritical,u=void 0!==c&&c,l=e.time,f=void 0===l?"Day":l,p=e.remainingAmmoModifier,h=void 0===p?1:p,d=e.optionalPowerModifiers;this.isPossible=function(){var e=t,r=e.defender,i=e.attackCalculator;return!!r.ship.shipType.isSubmarineClass&&"None"!==i.type},this.getFormationModifiers=function(){var e=t,r=e.attacker,i=e.defender,a=r.formation.getModifiers(r.role).asw,o={power:a.power,accuracy:a.accuracy,evasion:i.formation.getModifiers(i.role).asw.evasion};return n.a.isIneffective(r.formation,i.formation)?s(s({},o),{accuracy:1}):o},this.attacker=r,this.defender=i,this.engagement=a,this.isCritical=u,this.time=f,this.remainingAmmoModifier=h,this.optionalPowerModifiers=d,this.attackCalculator=o.a.fromShip(r.ship,f)}return Object.defineProperty(e.prototype,"power",{get:function(){var e=this.isCritical,t=this.optionalPowerModifiers,r=this.getFormationModifiers().power,i=this.engagement.modifier;return this.attackCalculator.calcPower({formationModifier:r,engagementModifier:i,isCritical:e,optionalModifiers:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){var e=this.getFormationModifiers().accuracy;return this.attackCalculator.calcAccuracy({formationModifier:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){var e=this.getFormationModifiers().evasion;return this.defender.ship.calcEvasionValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitRate",{get:function(){var t=this.accuracy,r=this.defender,n=this.evasion,a=r.ship.morale.evasionModifier,o=e.criticalRateMultiplier;return Object(i.b)({accuracy:t,evasion:n,moraleModifier:a,criticalRateMultiplier:o})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.power,t=this.defender,r=this.remainingAmmoModifier,i=t.ship.getDefensePower(),n=this.attackCalculator.armorPenetration;return new a.a(e.postcap,i,t.ship.health.currentHp,r,n)},enumerable:!0,configurable:!0}),e}();t.a=c,c.cap=150,c.criticalRateMultiplier=1.1},4217:function(e,t,r){"use strict";var i=r(162),n=r(241),a=r(558),o=r(98),s=function(){function e(e){var t=this,r=e.attacker,i=e.defender,n=e.engagement,o=e.isCritical,s=void 0!==o&&o,c=e.remainingAmmoModifier,u=void 0===c?1:c,l=e.innateTorpedoAccuracy,f=void 0===l?0:l,p=e.optionalPowerModifiers;this.getFormationModifiers=function(){var e=t,r=e.attacker,i=e.defender;return{attacker:r.formation.getModifiers(r.role).torpedo,defender:i.formation.getModifiers(i.role).torpedo}},this.attacker=r,this.defender=i,this.engagement=n,this.isCritical=s,this.remainingAmmoModifier=u,this.innateTorpedoAccuracy=f,this.optionalPowerModifiers=p,this.attackCalculator=a.a.fromShip(r.ship)}return Object.defineProperty(e.prototype,"power",{get:function(){var e=this.isCritical,t=this.optionalPowerModifiers,r=Object(n.d)(this.attacker,this.defender),i=this.getFormationModifiers().attacker.power,a=this.engagement.modifier;return this.attackCalculator.calcPower({fleetFactor:r,formationModifier:i,engagementModifier:a,isCritical:e,optionalModifiers:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){var e=Math.floor(.2*this.power.preCritical),t=this.getFormationModifiers().attacker.accuracy,r=this.innateTorpedoAccuracy;return this.attackCalculator.calcAccuracy({formationModifier:t,powerModifier:e,innateTorpedoAccuracy:r})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){var e=this.defender.ship,t=this.getFormationModifiers().defender.evasion,r=e.totalEquipmentStats((function(e){return e.improvement.torpedoEvasionModifier}));return e.calcEvasionValue(t,r)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitRate",{get:function(){var t=this.accuracy,r=this.defender,n=this.evasion,a=r.ship.morale.evasionModifier,o=e.criticalRateMultiplier;return Object(i.b)({accuracy:t,evasion:n,moraleModifier:a,criticalRateMultiplier:o})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.power,t=this.defender,r=this.remainingAmmoModifier,i=t.ship.getDefensePower();return new o.a(e.postcap,i,t.ship.health.currentHp,r)},enumerable:!0,configurable:!0}),e}();t.a=s,s.cap=150,s.criticalRateMultiplier=1.5,s.isPossible=function(e,t){return 0!==e.nakedStats.torpedo&&!t.isInstallation}},4218:function(e,t,r){"use strict";var i=r(560),n=r(98),a=r(162),o=r(49),s=function(){function e(e){var t=e.attacker,r=e.defender,n=e.specialAttack,a=e.isCritical,o=e.starshell,s=e.searchlight,c=e.nightContactModifier,u=e.remainingAmmoModifier,l=e.optionalPowerModifiers;this.attacker=t,this.defender=r,this.specialAttack=n,this.isCritical=a,this.starshell=o,this.searchlight=s,this.nightContactModifier=c,this.remainingAmmoModifier=u,this.optionalPowerModifiers=l,this.attackCalculator=new i.a(t.ship)}return Object.defineProperty(e.prototype,"contactModifiers",{get:function(){return 5===this.nightContactModifier?{power:5,accuracy:1.1,criticalRate:1.57}:{power:0,accuracy:1,criticalRate:e.criticalRateMultiplier}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){var e=this.attacker,t=this.specialAttack,r=this.starshell,i=this.searchlight,n=e.formation,a=e.role,o=n.getModifiers(a).night.accuracy,s=null==t?void 0:t.modifier.accuracy,c=this.contactModifiers.accuracy,u=r?5:0,l=i?7:0;return this.attackCalculator.calcAccuracy({starshellModifier:u,contactModifier:c,searchlightModifier:l,formationModifier:o,specialAttackModifier:s})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"power",{get:function(){var e=this,t=e.attacker,r=e.defender,i=e.isCritical,n=e.specialAttack,a=e.optionalPowerModifiers,s=t.role,c=t.formation.getModifiers(s).night.power,u=r.ship.isInstallation,l=t.ship.getSpecialEnemyModifiers(r.ship),f=Object(o.a)(l,a);return this.attackCalculator.calcPower({nightContactModifier:this.contactModifiers.power,formationModifier:c,specialAttack:n,isCritical:i,isAntiInstallation:u,modifiers:f})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defenderEvasionValue",{get:function(){var e=this.defender,t=e.ship,r=e.formation,i=e.role,n=r.getModifiers(i).night.evasion,a=t.shipType.isHeavyCruiserClass?5:0;return t.calcEvasionValue(n,a)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hitRate",{get:function(){var e=this.accuracy,t=this.defender,r=this.defenderEvasionValue,i=this.contactModifiers,n=t.ship.morale.evasionModifier;return Object(a.b)({accuracy:e,evasion:r,moraleModifier:n,criticalRateMultiplier:i.criticalRate})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defensePower",{get:function(){return this.defender.ship.getDefensePower()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"damage",{get:function(){var e=this.power,t=this.defensePower,r=this.remainingAmmoModifier,i=this.defender;return new n.a(e.postcap,t,i.ship.health.currentHp,r)},enumerable:!0,configurable:!0}),e}();t.a=s,s.criticalRateMultiplier=1.5},4219:function(e,t,r){"use strict";var i=function e(t,r,i){this.id=t,this.name=r,this.modifier=i,e.values.push(this)};t.a=i,i.values=[],i.Parallel=new i(1,"同航戦",1),i.HeadOn=new i(2,"反航戦",.8),i.CrossingTheTAdvantage=new i(3,"T有利",1.2),i.CrossingTheTDisadvantage=new i(4,"T不利",.6),i.random=function(e){void 0===e&&(e=!1);var t=Math.random();return t<.15?i.CrossingTheTAdvantage:t<.6?i.Parallel:t<.9||e?i.HeadOn:i.CrossingTheTDisadvantage}},4225:function(e,t,r){"use strict";var i=r(365),n=r(3465),a=r(49),o=r(98),s=r(162),c=function(){function e(e){var t=this,r=e.plane,i=e.target,n=e.contactModifier,c=e.proficiencyModifiers;this.calcPower=function(e){var r=t,i=r.slotSize,n=r.stat,o=r.typeModifier,s=r.contactModifier,c=r.proficiencyModifiers,u=o*(n*Math.sqrt(i)+0),l={a11:s},f=e?Object(a.c)(c.power):void 0;return Object(a.b)({basic:u,cap:150,modifiers:l,fm11next:f})},this.getHitRate=function(){var e=t,r=e.accuracy,i=e.evasion,n=e.proficiencyModifiers,a=e.target.morale.evasionModifier,o=n.hitRate,c=n.criticalRate;return Object(s.b)({accuracy:r,evasion:i,moraleModifier:a,hitRateBonus:o,criticalRateMultiplier:.2,criticalRateBonus:c})},this.getDamage=function(e){var r=t.target,i=t.calcPower(e).postcap;return new o.a(i,r.getDefensePower(),r.health.currentHp)},this.do=function(){var e=t.getHitRate(),r=Object(s.c)(e);if("Miss"!==r){var i=t.getDamage("Critical"===r);t.target.health.currentHp-=i.random()}},this.plane=r,this.target=i,this.contactModifier=n,this.proficiencyModifiers=c}return Object.defineProperty(e.prototype,"slotSize",{get:function(){return this.plane.slotSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){var e=this.plane.is;return e("JetPoweredFighterBomber")?"JetPoweredFighterBomber":e("DiveBomber")?"DiveBomber":e("TorpedoBomber")?"TorpedoBomber":"None"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stat",{get:function(){var e=this.plane;return e.is("DiveBomber")?e.gear.bombing:e.is("TorpedoBomber")?e.gear.torpedo:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeModifier",{get:function(){var e=this.type;return"JetPoweredFighterBomber"===e?1/Math.sqrt(2):"DiveBomber"===e?1:"TorpedoBomber"===e?Math.random()>.5?.8:1.5:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracy",{get:function(){return 95},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){return this.target.calcEvasionValue(1)},enumerable:!0,configurable:!0}),e}(),u=r(35),l=function e(t,r,i,n){var a=this;this.playerFleet=t,this.enemyFleet=r,this.enemyFormation=i,this.contactModifier=n,this.getTarget=function(){var e=a.enemyFleet.nonNullableShips.filter((function(e){return!e.shipType.isSubmarineClass})),t=Object(u.d)(e),r=e[0];if(t!==r)return t;if(!(Math.random()<a.enemyFormation.protectionRate))return t;var i=e.filter((function(e){return e!==t&&!e.isInstallation&&"Less"===e.health.damage}));return 0===i.length?t:Object(u.d)(i)},this.do=function(){var t=a,r=t.playerFleet,i=t.contactModifier;r.nonNullableShips.forEach((function(t){var r=t.getNormalProficiencyModifiers();t.planes.filter(e.isAirstrikePlane).forEach((function(e){var t=a.getTarget();new c({plane:e,target:t,contactModifier:i,proficiencyModifiers:r}).do()}))}))}},f=l;l.isAirstrikePlane=function(e){return e.slotSize>0&&(e.is("TorpedoBomber")||e.is("DiveBomber"))};var p=r(231),h=r(295),d=function(e,t){var r=i.a.fromFighterPower(e.fighterPower,t.fighterPower),n=r.constant;return e.planes.filter((function(e){return e.is("DiveBomber")||e.is("TorpedoBomber")||e.is("Fighter")})).forEach((function(e){var t=function(e){var t,r=e.slotSize,i=e.airControlStateConstant,n=e.side,a=e.fighterCombatResistModifier;if("Player"===n){var o=i/4,s=Math.floor(i/3*100);t=Math.floor(Math.random()*(s+1))/100+o}else{s=11-i;t=.35*Math.floor(Math.random()*(s+1))+.65*Math.floor(Math.random()*(s+1))}var c=t/10;return Math.floor(r*c*a)}({slotSize:e.slotSize,airControlStateConstant:n,side:"Player",fighterCombatResistModifier:1});e.shotdown(t)})),r},g=function(e){var t=e.playerFleet,r=e.enemyFleet,i=e.enemyFormation,a=d(t,r),o=new n.a(t.planes).getContactModifier(a);return function(e){var t=e.playerFleet,r=e.enemyFleet,i=e.enemyFormation,n=t.planes.filter(f.isAirstrikePlane),a=p.a.calcFleetAntiAir(r,"Enemy",i.fleetAntiAirModifier);n.forEach((function(e){var t=Object(u.d)(r.nonNullableShips),i=new h.a(t,"Enemy",a).getShotdownNumber(e);e.shotdown(i)}))}(e),new f(t,r,i,o).do(),a},m=function(){function e(){var e=this;this.Less=0,this.Shouha=0,this.Chuuha=0,this.Taiha=0,this.Sunk=0,this.increase=function(t){var r=t.health;e[r.damage]+=1}}return Object.defineProperty(e.prototype,"total",{get:function(){return this.Less+this.Shouha+this.Chuuha+this.Taiha+this.Sunk},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lessRate",{get:function(){return this.Less/this.total},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouhaRate",{get:function(){return this.Shouha/this.total},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chuuhaRate",{get:function(){return this.Chuuha/this.total},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"taihaRate",{get:function(){return this.Taiha/this.total},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sunkRate",{get:function(){return this.Sunk/this.total},enumerable:!0,configurable:!0}),e}(),b=function(){function e(){var e=this;this.countMap=new Map,this.increase=function(t){var r,i=t.slotSize,n=null!==(r=e.countMap.get(i))&&void 0!==r?r:0;e.countMap.set(i,n+1)},this.entries=function(){var t=e,r=t.total,i=t.countMap;return Array.from(i.entries(),(function(e){return[e[0],e[1]/r]}))}}return Object.defineProperty(e.prototype,"total",{get:function(){var e=0;return this.countMap.forEach((function(t){e+=t})),e},enumerable:!0,configurable:!0}),e}(),y=function(e){var t=this;this.ship=e,this.init=function(){var e=t,r=e.ship,i=e.initialSlots;r.health.currentHp=t.initialHp,i.forEach((function(e,t){r.slots[t]=e}))},this.initialHp=e.health.currentHp,this.initialSlots=e.slots.concat()},v=function(e){var t=this;this.init=function(){t.shipInitialStates.forEach((function(e){return e.init()}))},this.shipInitialStates=e.nonNullableShips.map((function(e){return new y(e)}))},A=r(4235),M=function(e){var t=this;this.creater=e,this.data=new Map,this.update=function(e){var r=t.data.get(e);r||(r=t.creater(),t.data.set(e,r)),r.increase(e)},this.entries=function(){return Array.from(t.data.entries())}},w=function(){function e(){var e=this;this.data=new Map,this.increase=function(t){var r=e.data.get(t);r?e.data.set(t,r+1):e.data.set(t,1)},this.getRate=function(t){var r;return(null!==(r=e.data.get(t))&&void 0!==r?r:0)/e.total},this.getRateList=function(){var t=[];e.data.forEach((function(r,i){t.push([i,e.getRate(i)])}));var r=0;return t.sort((function(e,t){var r=e[0];return t[0]-r})).map((function(e){var t=e[0],i=e[1];return[t,i,r+=i]}))}}return Object.defineProperty(e.prototype,"total",{get:function(){var e=0;return this.data.forEach((function(t){e+=t})),e},enumerable:!0,configurable:!0}),e}(),S=function(){var e=this;this.damageLog=new M((function(){return new m})),this.planeLossLog=new M((function(){return new b})),this.sunkCounter=new w,this.update=function(t,r){r.nonNullableShips.forEach((function(t){e.damageLog.update(t)}));var i=r.nonNullableShips.filter((function(e){return"Sunk"===e.health.damage})).length;e.sunkCounter.increase(i),t.planes.forEach((function(t){e.planeLossLog.update(t)}))}},P=function(e,t,r){var i=this;this.playerFleet=e,this.enemyFleet=t,this.enemyFormation=r,this.record=new S,this.init=function(){var e=i.initialState,t=e.playerFleet,r=e.enemyFleet;t.init(),r.init()},this.once=function(){var e=i,t=e.playerFleet,r=e.enemyFleet,n=e.enemyFormation;g({playerFleet:t,enemyFleet:r,enemyFormation:n}),i.record.update(t,r),i.init()},this.do=function(e){return Object(A.a)(e,i.once),i.record},this.initialState={playerFleet:new v(e),enemyFleet:new v(t)}};t.a=P},4234:function(e,t,r){"use strict";var i=r(4159),n=r(4161),a=r(4162),o=r(42),s=r(3482),c=function(){return(c=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},u=function(e){return"number"==typeof e?[e,e]:e},l=function(){function e(t,r,i){var n=this;this.shipType=r,this.shipClass=i,this.getNextShip=function(){if(n.canRemodel)return e.all.find((function(e){return n.remodel.nextId===e.shipId}))},this.getPrevShip=function(){return e.all.find((function(e){return e.remodel.nextId===n.shipId&&e.rank<n.rank}))},this.getRemodelGroupShips=function(){return e.all.filter((function(e){return e.remodelGroup===n.remodelGroup}))},this.shipId=t.id,this.shipClassId=i.id,this.sortNo=t.sortNo,this.sortId=t.sortId,this.name=t.name,this.readingName=t.readingName,this.hp=u(t.hp),this.armor=u(t.armor),this.firepower=u(t.firepower),this.torpedo=u(t.torpedo),this.antiAir=u(t.antiAir),this.luck=u(t.luck),this.asw=u(t.asw),this.evasion=u(t.evasion),this.los=u(t.los),this.speed=t.speed,this.range=t.range,this.fuel=t.fuel,this.ammo=t.ammo,this.slotCapacities=t.slotCapacities.concat(),this.initialEquipment=t.equipments.map((function(e){return"number"==typeof e?{id:e,improvement:0}:e})),t.remodel?this.remodel=t.remodel:this.remodel={nextId:0,nextLevel:0};var a=t.equippable?t.equippable:{};this.equippable=c({categories:this.shipType.equippableCategoryIds,expantionSlot:[]},a),e.all.push(this)}return Object.defineProperty(e.prototype,"isAbyssal",{get:function(){return this.shipId>e.abyssalIdFrom},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canRemodel",{get:function(){return this.remodel.nextId>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canConvert",{get:function(){if(!this.canRemodel)return!1;var e=this.getNextShip();if(!e)return!1;if(e.remodel.nextId===this.shipId)return!0;var t=e.getNextShip();return!!t&&t.remodel.nextId===this.shipId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"remodelGroup",{get:function(){if(this.remodelGroupMemo)return this.remodelGroupMemo;for(var e=this.shipId,t=this.getPrevShip();t;)e=t.shipId,t=t.getPrevShip();return this.remodelGroupMemo=e,e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rank",{get:function(){return this.sortId%10},enumerable:!0,configurable:!0}),e}(),f=l;l.all=new Array,l.abyssalIdFrom=1500;var p=r(542),h=r(4160),d=r(88),g=function(){function e(e,t,r){var i=this;this.id=e,this.name=t,this.equippableCategoryIds=r,this.is=function(e){return i.id===d.a[e]},this.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.some(i.is)},e===d.a.Battlecruiser&&(this.name="巡洋戦艦")}return Object.defineProperty(e.prototype,"isDestroyer",{get:function(){return this.id===d.a.Destroyer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLightCruiserClass",{get:function(){return this.any("LightCruiser","TorpedoCruiser","TrainingCruiser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeavyCruiserClass",{get:function(){return this.any("HeavyCruiser","AviationCruiser")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBattleshipClass",{get:function(){return this.any("Battlecruiser","Battleship","AviationBattleship","SuperDreadnoughts")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAircraftCarrierClass",{get:function(){return this.any("LightAircraftCarrier","AircraftCarrier","ArmoredAircraftCarrier")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSubmarineClass",{get:function(){return[d.a.Submarine,d.a.SubmarineAircraftCarrier].includes(this.id)},enumerable:!0,configurable:!0}),e}(),m=g;g.all=h.a.map((function(e){var t=Object.entries(e.api_equip_type).filter((function(e){e[0];return 1===e[1]})).map((function(e){var t=e[0];e[1];return Number(t)}));return new g(e.api_id,e.api_name,t)})),g.fromId=function(e){var t=g.all.find((function(t){return t.id===e}));if(t)return t;var r=new g(e,"",[]);return g.all.push(r),r};var b=function(e){var t=this;void 0===e&&(e=i.a),this.shipsData=e,this.findMasterGear=function(e){return t.gears.find((function(t){return t.id===e}))},this.findMasterShip=function(e){return t.ships.find((function(t){return t.shipId===e}))},this.shipIdToName=function(e){var r=t.ships.find((function(t){return t.shipId===e}));return r?r.name:""},this.shipNameToId=function(e){var r=t.ships.find((function(t){return t.name===e}));return r?r.shipId:0},this.shipClassIdToName=function(e){return p.a.fromId(e).name},this.shipTypeIdToName=function(e){return m.fromId(e).name},this.gearIdToName=function(e){var r=t.findMasterGear(e);return r?r.name:""},this.gearNameToId=function(e){var r=t.gears.find((function(t){return t.name===e}));return r&&r.id},this.gears=n.a.map((function(e){var t=e.api_id,r=e.api_type[2],i=o.b.find(r,t),n=a.a.includes(t);return new s.a(e,i,n)})),this.ships=e.map((function(e){var t=m.fromId(e.shipTypeId),r=p.a.fromId(e.classId);return new f(e,t,r)}))};t.a=b},49:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u}));var i=r(563),n=r(35),a=function(e,t){Object.entries(t).forEach((function(t){var r,i=t[0],n=t[1];"number"==typeof n&&(r=i.startsWith("a")?(e[i]||1)*n:(e[i]||0)+n,e[i]=r)}))},o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r={};return e.forEach((function(e){return e&&a(r,e)})),r},s=function(e,t,r){return void 0===e&&(e=1),void 0===t&&(t=0),void 0===r&&(r=!1),function(i){var n=i*e+t;return r?Math.floor(n):n}},c=function(e){return void 0===e&&(e=1),function(t){return Math.floor(1.5*t*e)}},u=function(e){var t=e.basic,r=e.cap,a=e.modifiers,o=e.fm14prev,c=e.fm11next,u=function(e,t){var r=e.a12,n=e.a13,a=e.a13next,o=e.a14,c=e.b12,u=e.b13,l=e.b13next,f=e.b14,p=s(r,c),h=s(n,u),d=s(a,l),g=s(o,f);return t?Object(i.a)(p,h,d,t,g):Object(i.a)(p,h,d,g)}(a,o),l=function(e){var t=e.a5,r=e.a6,n=e.a11,a=e.b5,o=e.b6,c=e.b11,u=s(t,a,!0),l=s(r,o,!0),f=s(n,c);return Object(i.a)(u,l,f)}(a),f=u(t),p=r<f,h=Object(n.e)(r,f),d=l(h);return c&&(d=c(d)),{precap:f,isCapped:p,capped:h,postcap:d}}},536:function(e,t,r){"use strict";r.d(t,"b",(function(){return n}));var i=r(201),n=["hp","firepower","armor","torpedo","evasion","antiAir","asw","speed","los","range","luck"],a=function(){function e(e,t,r){this.master=e,this.level=t,this.increased=r}return e.prototype.getIncreasedStat=function(e){var t=this.increased;if(!t)return 0;var r=t[e];return r?r>1e5?1e5:r:0},Object.defineProperty(e.prototype,"hp",{get:function(){return Object(i.a)(this.master.hp,this.level)+this.getIncreasedStat("hp")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firepower",{get:function(){return this.master.firepower[1]+this.getIncreasedStat("firepower")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"torpedo",{get:function(){return this.master.torpedo[1]+this.getIncreasedStat("torpedo")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antiAir",{get:function(){return this.master.antiAir[1]+this.getIncreasedStat("antiAir")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"armor",{get:function(){return this.master.armor[1]+this.getIncreasedStat("armor")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"los",{get:function(){return Object(i.b)(this.master.los,this.level)+this.getIncreasedStat("los")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asw",{get:function(){return Object(i.b)(this.master.asw,this.level)+this.getIncreasedStat("asw")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evasion",{get:function(){return Object(i.b)(this.master.evasion,this.level)+this.getIncreasedStat("evasion")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"luck",{get:function(){return this.master.luck[0]+this.getIncreasedStat("luck")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this.master.speed+this.getIncreasedStat("speed")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this.master.range+this.getIncreasedStat("range")},enumerable:!0,configurable:!0}),e}();t.a=a},537:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return n}));var i=function(e){var t=e.hasArmorPiercingShell,r=e.hasMainGun,i=e.hasRader,n=e.hasSecondaryGun;return t&&r?n&&i?{power:1.15,accuracy:1.3}:n?{power:1.15,accuracy:1.2}:i?{power:1.1,accuracy:1.25}:{power:1.08,accuracy:1.1}:{power:1,accuracy:1}},n=function(e){var t=e.isLightCruiserClass,r=e.isZaraClass,i=e.singleGunCount,n=e.twinGunCount,a=e.zaraGunCount;return t?Math.sqrt(i)+2*Math.sqrt(n):r?Math.sqrt(a):0}},542:function(e,t,r){"use strict";var i=r(3483),n=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i},a=Object.entries(i.b).filter((function(e){return"number"==typeof e[1]})),o=function(){function e(e,t){var r=this;this.name=e,this.id=t,this.is=function(e){return r.id===i.a[e]},this.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.some(r.is)}}return e.fromId=function(t){var r=e.all.find((function(e){return e.id===t}));if(r)return r;var i=new e("unknown",t);return e.all.push(i),i},Object.defineProperty(e.prototype,"isSpecialTypeDestroyer",{get:function(){return this.any("FubukiClass","AyanamiClass","AkatsukiClass")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUsNavy",{get:function(){return this.any("JohnCButlerClass","FletcherClass","IowaClass","LexingtonClass","EssexClass","CasablancaClass","ColoradoClass")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRoyalNavy",{get:function(){return this.any("QueenElizabethClass","NelsonClass","ArkRoyalClass","JClass")},enumerable:!0,configurable:!0}),e}();t.a=o,o.all=a.map((function(e){return new(o.bind.apply(o,n([void 0],e)))}))},543:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(4123),n=function(e,t){var r=Object(i.a)(e.filter((function(e){return e.level<=t})),"value");return r?r.value:0},a={from:function(e){var t=function(t){return e.includes(t)};return t("Fighter")?"Fighter":t("SeaplaneBomber")?"SeaplaneBomber":t("DiveBomber")||t("TorpedoBomber")||t("ReconnaissanceAircraft")?"Other":"None"}},o=function(){function e(e,t){void 0===e&&(e=0),this.internal=e,this.type=t}return e.internalToLevel=function(t){return e.internalBounds.filter((function(e){return e<=t})).length-1},Object.defineProperty(e.prototype,"visible",{get:function(){return"None"!==this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return e.internalToLevel(this.internal)},set:function(t){this.internal=e.internalBounds[t]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fighterPowerBonus",{get:function(){var t=this.internal,r=this.level,i=this.type;if(t<=0)return 0;var a=[];return"Fighter"===i?a=e.fighterPowerLevelBonuses.fighter:"SeaplaneBomber"===i&&(a=e.fighterPowerLevelBonuses.seaplaneBomber),n(a,r)+Math.sqrt(t/10)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"criticalPowerModifier",{get:function(){var t=this.internal,r=this.level,i=n(e.criticalModifierLevelBonuses,r);return Math.floor(Math.sqrt(t)+i)},enumerable:!0,configurable:!0}),e}();t.b=o,o.internalBounds=[0,10,25,40,55,70,85,100],o.fighterPowerLevelBonuses={fighter:[{level:7,value:22},{level:5,value:14},{level:4,value:9},{level:3,value:5},{level:2,value:2},{level:0,value:0}],seaplaneBomber:[{level:7,value:6},{level:5,value:3},{level:2,value:1},{level:0,value:0}]},o.criticalModifierLevelBonuses=[{level:7,value:10},{level:6,value:7},{level:5,value:5},{level:4,value:4},{level:3,value:3},{level:2,value:2},{level:1,value:1},{level:0,value:0}]},557:function(e,t,r){"use strict";var i=r(49),n=r(240),a=function(){function e(e){var t=this;this.ship=e,this.getCarrierShellingFm=function(e){void 0===e&&(e=!1);var r=t,i=r.ship;if("Shelling"!==r.type){var n=e?0:i.totalEquipmentStats("torpedo"),a=e?i.totalEquipmentStats((function(e){return e.is("AntiInstallationBomber")?e.bombing:0})):i.totalEquipmentStats("bombing"),o=Math.floor(Math.floor(1.3*a)+n)+15;return function(e){return 25+Math.floor(1.5*(e+o))}}},this.calcPower=function(e){var r=t.ship,n=e.formationModifier,a=e.engagementModifier,o=e.isCritical,s=e.isAntiInstallation,c=4+r.stats.firepower,u={a14:n*a*r.health.shellingPowerModifier},l=t.getCarrierShellingFm(s),f=o?Object(i.c)():void 0;return Object(i.b)({basic:c,cap:150,modifiers:u,fm14prev:l,fm11next:f})},this.calcAccuracy=function(e){var r=t.accuracyShipFactors,i=r.shipAccuracy,n=r.equipmentAccuracy,a=r.moraleModifier,o=e.formationModifier,s=Math.floor(64+i+n);return Math.floor(s*o*a)}}return Object.defineProperty(e.prototype,"type",{get:function(){return Object(n.b)(this.ship)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accuracyShipFactors",{get:function(){var e=this.ship;return{shipAccuracy:e.shipAccuracy,equipmentAccuracy:e.totalEquipmentStats("accuracy"),moraleModifier:e.morale.getAccuracyModifier("shelling")}},enumerable:!0,configurable:!0}),e}();t.a=a},558:function(e,t,r){"use strict";var i=r(49),n=function(){return(n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},a=function(e){var t=this;this.state=e,this.calcPower=function(e){return function(e){var t=e.torpedo,r=e.improvementModifier,a=e.healthModifier,o=e.fleetFactor,s=e.formationModifier,c=e.engagementModifier,u=e.isCritical,l=e.optionalModifiers,f=s*c*a,p=Object(i.a)({a14:f},l),h=t+r+o,d=Object(i.b)({basic:h,cap:150,modifiers:p}),g=d.postcap;if(!u)return n(n({},d),{preCritical:g});var m=Math.floor(1.5*d.postcap);return n(n({},d),{preCritical:g,postcap:m})}(n(n({},t.state.power),e))},this.calcAccuracy=function(e){return r=n(n({},t.state.accuracy),e),i=r.shipAccuracy,a=r.equipmentAccuracy,o=r.improvementModifier,s=r.powerModifier,c=r.innateTorpedoAccuracy,u=r.formationModifier,l=r.moraleModifier,f=85+i+a+o+s+c,Math.floor(f*u*l);var r,i,a,o,s,c,u,l,f}};t.a=a,a.fromShip=function(e){var t=e.shipAccuracy,r={power:{torpedo:e.stats.torpedo,improvementModifier:e.totalEquipmentStats((function(e){return e.improvement.torpedoPowerModifier})),healthModifier:e.health.torpedoPowerModifier},accuracy:{shipAccuracy:t,equipmentAccuracy:e.totalEquipmentStats("accuracy"),improvementModifier:e.totalEquipmentStats((function(e){return e.improvement.torpedoAccuracyModifier})),moraleModifier:e.morale.getAccuracyModifier("torpedo")}};return new a(r)}},559:function(e,t,r){"use strict";var i=r(308),n=r(49),a=function(){return(a=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o=function(e){var t=e.hasGear,r=1,i=1;return(t("Sonar")||t("LargeSonar"))&&t("DepthCharge")&&(r=1.15),t("AdditionalDepthCharge")&&t("DepthChargeProjector")&&(i=t("Sonar")?1.25:1.1),r*i},s=function(e){var t=e.shipType.is("CoastalDefenseShip")?1:0;return e.totalEquipmentStats((function(e){return e.is("AdditionalDepthCharge")?Math.sqrt(e.asw-2)+t:0}))},c=function(){function e(e){var t=this;this.state=e,this.calcBasicPower=function(e){void 0===e&&(e=0);var r=t.state.power,i=r.nakedAsw,n=r.equipmentAsw,a=r.improvementModifier,o=r.typeConstant;return 2*Math.sqrt(i)+1.5*n+a+o},this.calcPower=function(e){var r,o=t.state.power.proficiencyModifier;return e.isCritical&&(r=Object(n.c)(o)),i.a.createPower(a(a(a({},t.state.power),e),{fm11next:r}))},this.calcAccuracy=function(e){return i.a.calcAccuracy(a(a({},t.state.accuracy),e))}}return Object.defineProperty(e.prototype,"armorPenetration",{get:function(){return this.state.armorPenetration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.state.type},enumerable:!0,configurable:!0}),e}();t.a=c,c.fromShip=function(e,t){var r=function(e,t){var r=e.shipAccuracy,i=function(e,t){return void 0===t&&(t=!1),!t&&function(e){return!(!e.shipType.any("AviationCruiser","AviationBattleship","SeaplaneTender","LightAircraftCarrier","AmphibiousAssaultShip")&&!e.shipClass.is("RevisedKazahayaClass"))&&e.planes.some((function(e){return e.slotSize>0&&e.is("AswAircraft")}))}(e)?"AircraftCarrier":function(e){return 0!==e.nakedStats.asw&&!e.shipClass.any("FusouClass","IseClass","R1")}(e)?"DepthCharge":"None"}(e,"Night"===t),n=e.totalEquipmentStats((function(e){return e.is("Sonar")?2*e.asw:e.is("AdditionalDepthCharge")?e.asw:0})),a=1;return"AircraftCarrier"!==i||"Opening"===t||e.shipClass.is("RevisedKazahayaClass")||(a=e.getNormalProficiencyModifiers().power),{power:{nakedAsw:e.nakedStats.asw,equipmentAsw:e.totalEquipmentStats((function(e){return e.is("AswGear")?e.asw:0})),improvementModifier:e.totalEquipmentStats((function(e){return e.improvement.aswPowerModifier})),typeConstant:"DepthCharge"===i?13:8,healthModifier:e.health.aswPowerModifier,synergyModifier:o(e),proficiencyModifier:a},accuracy:{shipAccuracy:r,aswEquipmentModifier:n,improvementModifier:e.totalEquipmentStats((function(e){return e.improvement.aswAccuracyModifier})),moraleModifier:e.morale.getAccuracyModifier("asw")},armorPenetration:s(e),type:i}}(e,t);return new c(r)}},560:function(e,t,r){"use strict";var i=r(564),n=r(49),a=r(3434),o=function(){function e(e){var t=this;this.ship=e,this.calcNightAerialAttackPower=function(e){var r=t,n=r.ship;return"NightAerialAttack"!==r.type?0:n.nakedStats.firepower+Object(i.a)(n.planes,(function(t){return t.calcNightAerialAttackPower(e)}))},this.calcBasicPower=function(e,r){var i=t,n=i.ship,a=i.type,o=n.stats.firepower,s=r?0:n.stats.torpedo,c=n.totalEquipmentStats((function(e){return e.improvement.nightAttackPowerModifier}));return"NightAerialAttack"===a?t.calcNightAerialAttackPower(r)+e:o+s+c+e},this.getCriticalFm=function(){if("NightAerialAttack"===t.type){var e=t.ship.getNormalProficiencyModifiers();return Object(n.c)(e.power)}return Object(n.c)()},this.calcPower=function(e){var r=e.nightContactModifier,i=e.formationModifier,a=e.specialAttack,o=e.isCritical,s=e.isAntiInstallation,c=t.calcBasicPower(r,s),u=t.ship.health.nightAttackPowerModifier,l=1,f=1;a&&(l=a.modifier.power,a.isDestroyerCutin&&(f=t.typeDModifier));var p=i*u*l*f,h=t.ship.getCruiserFitBonus(),d=Object(n.a)({a14:p,b14:h},e.modifiers),g=o?t.getCriticalFm():void 0;return Object(n.b)({basic:c,cap:300,modifiers:d,fm11next:g})},this.calcAccuracy=function(e){var r=e.starshellModifier,i=e.contactModifier,n=e.searchlightModifier,a=e.formationModifier,o=e.specialAttackModifier,s=void 0===o?1:o,c=e.fitGunBonus,u=void 0===c?0:c,l=t.ship,f=l.shipAccuracy,p=l.shipType,h=l.hasGear,d=l.totalEquipmentStats("accuracy"),g=l.totalEquipmentStats((function(e){return e.improvement.nightAttackAccuracyModifier})),m=l.morale.getAccuracyModifier("night"),b=0;p.isHeavyCruiserClass&&(h(6)&&(b=10),(h(90)||h(50))&&(b=15));var y=Math.floor((69+r)*i+f+d+g);return Math.floor(y*a*m*s+n+b+u)}}return Object.defineProperty(e.prototype,"type",{get:function(){var e=this.ship;return Object(a.b)(e)?"NightAerialAttack":"NightAttack"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeDModifier",{get:function(){var e=this.ship,t=e.countGear(267),r=e.countGear(366),i=t+r,n=1;return 0===i||(1===i&&(n=1.25),i>=2&&(n=1.4),r&&(n*=1.05)),n},enumerable:!0,configurable:!0}),e}();t.a=o},561:function(e,t,r){"use strict";var i=r(35),n=r(4123),a=r(3489),o=function(e){if(Array.isArray(e)){var t=e.map(o);return Object(n.a)(t,(function(e){return e&&e.id}))}var r=e,i=Object(a.a)(100);return l.getPossibleAntiAirCutins(r).find((function(e){return e.isSpecialAaci()?e.probability>Object(a.a)(100):e.probability>i}))},s=o,c=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,n++)i[n]=a[o];return i},u=function(){function e(e,t,r,i){var n=this;this.id=e,this.minimumBonus=t,this.fixedAirDefenseModifier=r,this.probability=i,this.isSpecialAaci=function(){return[34,35,39,40,41].includes(n.id)}}return e.fromId=function(e){return this.all.find((function(t){return t.id===e}))},e}(),l=t.a=u;u.all=[[1,8,1.7,65],[2,7,1.7,58],[3,5,1.6,50],[4,7,1.5,52],[5,5,1.5,55],[6,5,1.45,40],[7,4,1.35,45],[8,5,1.4,50],[9,3,1.3,40],[10,9,1.65,60],[11,7,1.5,55],[12,4,1.25,45],[13,5,1.35,35],[14,5,1.45,63],[15,4,1.3,58],[16,5,1.4,60],[17,3,1.25,55],[18,3,1.2,60],[19,6,1.45,55],[20,4,1.25,70],[21,6,1.45,60],[22,3,1.2,63],[23,2,1.05,80],[24,4,1.25,60],[25,8,1.55,60],[26,7,1.4,60],[28,5,1.4,53],[29,6,1.55,58],[30,4,1.3,42],[31,3,1.25,50],[32,4,1.2,32],[33,4,1.35,42],[34,8,1.6,60],[35,7,1.55,53],[36,7,1.55,59],[37,5,1.45,38],[39,11,1.7,60],[40,11,1.7,60],[41,10,1.65,60]].map((function(e){return new(u.bind.apply(u,c([void 0],e)))})),u.try=s,u.getPossibleAntiAirCutins=function(e){return function(e){var t,r=e.shipId,i=e.hasGear;!function(e){e[e.MayaKai2=428]="MayaKai2",e[e.IsuzuKai2=141]="IsuzuKai2",e[e.KasumiKai2B=470]="KasumiKai2B",e[e.KinuKai2=487]="KinuKai2",e[e.YuraKai2=488]="YuraKai2",e[e.MusashiKai=148]="MusashiKai",e[e.MusashiKai2=546]="MusashiKai2",e[e.IsokazeBKai=557]="IsokazeBKai",e[e.HamakazeBKai=558]="HamakazeBKai",e[e.SatsukiKai2=418]="SatsukiKai2",e[e.FumizukiKai2=548]="FumizukiKai2",e[e.Uit25=539]="Uit25",e[e.I504=530]="I504",e[e.TatsutaKai2=478]="TatsutaKai2"}(t||(t={}));var n=function(t){return e.masterId===t},a=function(e){return e.is("HighAngleMount")},o=function(e){return a(e)&&e.antiAir>=8},s=function(e){return e.is("Radar")},c=function(e){return e.is("AirRadar")},u=function(e){return e.is("AntiAircraftGun")},l=function(e){return u(e)&&e.antiAir>=9},f=function(e){return u(e)&&e.antiAir>=3&&e.antiAir<9},p=function(e){return 274===e.gearId},h=function(e){return e.is("AntiAircraftShell")},d=function(e){return e.is("AntiAircraftFireDirector")},g=function(e){return e.category.any("LargeCaliberMainGun","LargeCaliberMainGun2")},m=function(t,r){return e.countGear(t)>=r},b=function(t){return e.hasGear(t)},y=[];if(e.shipClass.is("FletcherClass")){var v=e.countGear(313),A=e.countGear(284)+v,M=e.countGear(308);M>=2&&y.push(34),M>0&&A>0&&y.push(35),A>=2&&e.hasGear(307)&&y.push(36),v>=2&&y.push(37)}var w=e.countGear(363),S=e.countGear(362)+w;return e.shipClass.is("AtlantaClass")&&S>=2&&(w>=1&&y.push(39),e.hasGear(307)&&y.push(40),y.push(41)),e.shipClass.is("AkizukiClass")&&b(a)?(m(a,2)&&b(s)&&y.push(1),b(s)&&y.push(2),m(a,2)&&y.push(3)):(n(t.MayaKai2)&&b(a)&&b(l)&&(b(c)&&y.push(10),y.push(11)),n(t.IsuzuKai2)&&b(a)&&b(u)&&(b(c)&&y.push(14),y.push(15)),n(t.KasumiKai2B)&&b(a)&&b(u)&&(b(c)&&y.push(16),y.push(17)),622===r&&i("HighAngleMount")&&i("AntiAircraftGun")&&i("AirRadar")&&y.push(16),n(t.KinuKai2)&&b(l)&&b((function(e){return a(e)&&e.antiAir<8}))&&y.push(19),n(t.YuraKai2)&&b(a)&&b(c)&&y.push(21),e.shipClass.is("IseClass")&&e.shipType.is("AviationBattleship")&&b(p)&&b(h)&&b(c)&&y.push(25),b(d)&&b(g)&&b(h)&&b(c)&&y.push(4),m(o,2)&&b(c)&&y.push(5),b(d)&&b(g)&&b(h)&&y.push(6),b(o)&&b(c)&&y.push(8),b(d)&&b(a)&&b(c)&&y.push(7),n(t.MusashiKai2)&&b((function(e){return 275===e.gearId}))&&b(s)&&y.push(26),(e.shipClass.is("IseClass")&&e.shipType.is("AviationBattleship")||n(t.MusashiKai)||n(t.MusashiKai2))&&b(p)&&b(c)&&y.push(28),(n(t.IsokazeBKai)||n(t.HamakazeBKai))&&b(a)&&b(c)&&y.push(29),b(d)&&b(a)&&y.push(9),[579,630].includes(e.shipId)&&e.hasGear(a)&&e.hasGear((function(e){return e.is("AntiAircraftGun")&&e.antiAir>=4}))&&y.push(33),b(l)&&b(c)&&e.countGear((function(e){return e.is("AntiAircraftGun")&&e.antiAir>=3}))>=2&&y.push(12),b(o)&&b(l)&&b(c)&&y.push(13),n(t.SatsukiKai2)&&b(l)&&y.push(18),n(t.KinuKai2)&&b(l)&&y.push(20),n(t.FumizukiKai2)&&b(l)&&y.push(22),(n(t.Uit25)||n(t.I504))&&b(f)&&y.push(23),["龍田改二","天龍改二"].includes(e.name)&&b(a)&&b(f)&&y.push(24),["天龍改二","Gotland改"].includes(e.name)&&e.countGear(a)>=3&&y.push(30),"天龍改二"===e.name&&e.countGear(a)>=2&&y.push(31),(e.shipClass.isRoyalNavy||e.shipClass.is("KongouClass")&&e.name.includes("改二"))&&(e.countGear(301)>=2||e.hasGear(301)&&e.hasGear(191)||e.hasGear(300)&&e.hasGear(191))&&y.push(32)),y}(e).map((function(e){return u.fromId(e)})).filter(i.b)}},562:function(e,t,r){"use strict";var i;!function(e){e.MainFleet="MainFleet",e.EscortFleet="EscortFleet"}(i||(i={})),t.a=i},606:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){var t=e.slotSize,r=e.antiAir,i=e.interception,n=void 0===i?0:i,a=e.antiBomber,o=void 0===a?0:a,s=e.improvementModifier,c=void 0===s?0:s,u=e.proficiencyModifier,l=void 0===u?0:u,f=e.isInterception,p=r+1.5*n+c;return void 0!==f&&f&&(p=r+n+2*o+c),Math.floor(p*Math.sqrt(t)+l)}},607:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e,t){return e.includes(t)}},608:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var i=function(e){var t=e.evasion,r=e.luck,i=e.improvementModifier,n=e.formationModifier,a=e.postcapModifier,o=void 0===a?0:a,s=e.additionalFm,c=Math.floor((t+Math.sqrt(2*r))*n),u=c;c>=65?u=Math.floor(55+2*Math.sqrt(c-65)):c>=40&&(u=Math.floor(40+3*Math.sqrt(c-40)));var l=Math.floor(u+o)+i;return s?s(l):l}},66:function(e,t,r){"use strict";r.r(t);var i=r(537);r.d(t,"getApShellModifiers",(function(){return i.b})),r.d(t,"calcCruiserFitBonus",(function(){return i.a}));var n=r(606);r.d(t,"calcFighterPower",(function(){return n.a}));var a=r(201);r.d(t,"calcStatAtLevel",(function(){return a.b})),r.d(t,"calcHpAtLevel",(function(){return a.a}));var o=r(308);r.d(t,"Asw",(function(){return o.a}));var s=r(162);r.d(t,"calcHitRateBasis",(function(){return s.a})),r.d(t,"createHitRate",(function(){return s.b})),r.d(t,"getHitStatus",(function(){return s.c}));var c=r(608);r.d(t,"calcEvasionValue",(function(){return c.a}))},88:function(e,t,r){"use strict";var i;!function(e){e[e.CoastalDefenseShip=1]="CoastalDefenseShip",e[e.Destroyer=2]="Destroyer",e[e.LightCruiser=3]="LightCruiser",e[e.TorpedoCruiser=4]="TorpedoCruiser",e[e.HeavyCruiser=5]="HeavyCruiser",e[e.AviationCruiser=6]="AviationCruiser",e[e.LightAircraftCarrier=7]="LightAircraftCarrier",e[e.Battlecruiser=8]="Battlecruiser",e[e.Battleship=9]="Battleship",e[e.AviationBattleship=10]="AviationBattleship",e[e.AircraftCarrier=11]="AircraftCarrier",e[e.SuperDreadnoughts=12]="SuperDreadnoughts",e[e.Submarine=13]="Submarine",e[e.SubmarineAircraftCarrier=14]="SubmarineAircraftCarrier",e[e.Transport=15]="Transport",e[e.SeaplaneTender=16]="SeaplaneTender",e[e.AmphibiousAssaultShip=17]="AmphibiousAssaultShip",e[e.ArmoredAircraftCarrier=18]="ArmoredAircraftCarrier",e[e.RepairShip=19]="RepairShip",e[e.SubmarineTender=20]="SubmarineTender",e[e.TrainingCruiser=21]="TrainingCruiser",e[e.FleetOiler=22]="FleetOiler"}(i||(i={})),t.a=i},98:function(e,t,r){"use strict";var i=r(3487),n=function(){function e(e,t,r,i,n){var a=this;void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=0),this.attackPower=e,this.defensePower=t,this.defenderCurrentHp=r,this.remainingAmmoModifier=i,this.armorPenetration=n,this.calcValue=function(e){var t=a,r=t.attackPower,i=t.remainingAmmoModifier,n=t.armorPenetration,o=Math.max(1,e-n),s=Math.floor((r-o)*i);return Math.max(0,s)},this.random=function(){return a.calcValue(a.defensePower.random())}}return Object.defineProperty(e.prototype,"min",{get:function(){return this.calcValue(this.defensePower.max)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.calcValue(this.defensePower.min)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var e=this.defensePower,t=this.calcValue;return e.values().map(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeadly",{get:function(){var e=this.min;return this.defenderCurrentHp<=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scratchDamageProbability",{get:function(){var e=this.values;return e.filter((function(e){return e<=0})).length/e.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scratchDamages",{get:function(){var e=this.defenderCurrentHp;return Object(i.a)(e).map((function(t){return Math.floor(.06*e+.08*t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deadlyDamageProbability",{get:function(){var e=this.values,t=this.defenderCurrentHp;return e.filter((function(e){return t-e<=0})).length/e.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stopperDamages",{get:function(){var e=this.defenderCurrentHp;return Object(i.a)(e).map((function(t){return Math.floor(.5*e+.3*t)}))},enumerable:!0,configurable:!0}),e}();t.a=n,n.calc=function(e,t,r){return void 0===e&&(e=0),void 0===r&&(r=1),new n(e,t,r).random()}}}]);